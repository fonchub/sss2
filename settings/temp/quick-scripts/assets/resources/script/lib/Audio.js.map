{"version":3,"sources":["Audio.js"],"names":["cc","Class","extends","Component","properties","bgVolume","deskVolume","bgAudioID","init","t","sys","localStorage","getItem","parseFloat","game","on","EVENT_HIDE","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","raw","playBGM","audioUrl","stop","play","playSFX","sfxVolume","audioId","setSFXVolume","v","setItem","getState","setBGMVolume","force","AudioState","PAUSED","resume","pause","bgmVolume","setVolume"],"mappings":"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","file":"Audio.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\resources\\script\\lib","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        bgVolume:1.0,           // 背景音量\n\n        deskVolume:1.0,         //   房间 房间音量\n        \n        bgAudioID:-1            //   背景 音乐  id\n    },\n\n    // use this for initialization\n    init: function () {\n        var t = cc.sys.localStorage.getItem(\"bgVolume\");\n        if(t != null){\n            this.bgVolume = parseFloat(t);    \n        }\n        \n        var t = cc.sys.localStorage.getItem(\"deskVolume\");\n\n        if(t != null){\n            this. deskVolume = parseFloat(t);    \n        }\n        \n        cc.game.on(cc.game.EVENT_HIDE, function () {\n            cc.audioEngine.pauseAll();\n        });\n        cc.game.on(cc.game.EVENT_SHOW, function () {\n            cc.audioEngine.resumeAll();\n        });\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n    \n    getUrl:function(url){\n        return cc.url.raw(\"resources/sounds/\" + url);\n    },\n    //游戏音乐\n    playBGM:function(url){\n        var audioUrl = this.getUrl(url);\n        if(this.bgAudioID >= 0){\n            cc.audioEngine.stop(this.bgAudioID);\n        }\n                                    //播放音频(音频剪辑,音乐是否循环,音乐体积)\n        this.bgAudioID = cc.audioEngine.play(audioUrl,true,this.bgVolume);\n    },\n    //游戏特效\n    playSFX:function(url){\n        var audioUrl = this.getUrl(url);\n        if(this.sfxVolume > 0){\n            var audioId = cc.audioEngine.play(audioUrl,false,this.deskVolume);    \n        }\n    },\n    //设置特效体积\n    setSFXVolume:function(v){\n        if(this.sfxVolume != v){\n            cc.sys.localStorage.setItem(\"deskVolume\",v);\n            this.deskVolume = v;\n        }\n    },\n\n    getState:function(){\n        return cc.audioEngine.getState(this.bgAudioID);\n    },\n    //设置游戏音乐\n    setBGMVolume:function(v,force){\n        if(this.bgAudioID >= 0){\n            if(v > 0 && cc.audioEngine.getState(this.bgAudioID) === cc.audioEngine.AudioState.PAUSED){\n                cc.audioEngine.resume(this.bgAudioID);\n            }else if(v == 0){\n                cc.audioEngine.pause(this.bgAudioID);\n            }\n        }\n        if(this.bgVolume != v || force){\n            cc.sys.localStorage.setItem(\"bgVolume\",v);\n            this.bgmVolume = v;\n            cc.audioEngine.setVolume(this.bgAudioID,v);\n        }\n    },\n    //暂停所有\n    pauseAll:function(){\n        cc.audioEngine.pauseAll();\n    },\n    //继续所有\n    resumeAll:function(){\n        cc.audioEngine.resumeAll();\n    }\n});\n"]}