{"version":3,"sources":["socket.io.js"],"names":["cc","Class","extends","Component","properties","connect","url","options","self","ws","WebSocket","beimi","user","id","onopen","event","console","log","onmessage","data","parse","onerror","onclose","on","command","func","exec","readyState","OPEN","userid","orgi","token","authorization","send","JSON","stringify","emit","param","disconnect","result"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,WAASF,GAAGG,SADP;;AAGLC,cAAY,EAHP;;AAOLC,WAAQ,iBAASC,GAAT,EAAeC,OAAf,EAAuB;AAC3B,QAAIC,OAAO,IAAX;AACA,SAAKC,EAAL,GAAU,IAAIC,SAAJ,CAAcJ,MAAI,UAAJ,GAAeN,GAAGW,KAAH,CAASC,IAAT,CAAcC,EAA3C,CAAV;AACA,SAAKJ,EAAL,CAAQK,MAAR,GAAiB,UAAUC,KAAV,EAAiB;AAC9BC,cAAQC,GAAR,CAAY,0BAAZ;AACH,KAFD;AAGA,SAAKR,EAAL,CAAQS,SAAR,GAAoB,UAAUH,KAAV,EAAiB;AACjC,UAAII,OAAOX,KAAKY,KAAL,CAAWL,MAAMI,IAAjB,CAAX;AACA,UAAGA,QAAM,IAAN,IAAcA,KAAKJ,KAAL,IAAc,IAA/B,EAAoC;AAChCf,WAAGW,KAAH,CAASI,KAAT,CAAeI,KAAKJ,KAApB,EAA2BA,MAAMI,IAAjC;AACH;AACDH,cAAQC,GAAR,CAAY,wBAAwBF,MAAMI,IAA1C;AACH,KAND;AAOA,SAAKV,EAAL,CAAQY,OAAR,GAAkB,UAAUN,KAAV,EAAiB;AAC/BC,cAAQC,GAAR,CAAY,0BAAZ;AACH,KAFD;AAGA,SAAKR,EAAL,CAAQa,OAAR,GAAkB,UAAUP,KAAV,EAAiB;AAC/BC,cAAQC,GAAR,CAAY,4BAAZ;AACH,KAFD;AAGA,WAAO,IAAP;AACH,GA3BI;AA4BLM,MAAG,YAASC,OAAT,EAAmBC,IAAnB,EAAwB;AACvBzB,OAAGW,KAAH,CAASI,KAAT,CAAeS,OAAf,IAA2BC,IAA3B;AACH,GA9BI;AA+BLC,QAAK,cAASF,OAAT,EAAmBL,IAAnB,EAAwB;AACzB,QAAI,KAAKV,EAAL,CAAQkB,UAAR,KAAuBjB,UAAUkB,IAArC,EAA2C;AACvCT,WAAKK,OAAL,GAAeA,OAAf;AACAL,WAAKU,MAAL,GAAc7B,GAAGW,KAAH,CAASC,IAAT,CAAcC,EAA5B;AACAM,WAAKW,IAAL,GAAY9B,GAAGW,KAAH,CAASC,IAAT,CAAckB,IAA1B;AACAX,WAAKY,KAAL,GAAa/B,GAAGW,KAAH,CAASqB,aAAtB;AACA,WAAKvB,EAAL,CAAQwB,IAAR,CAAaC,KAAKC,SAAL,CAAehB,IAAf,CAAb;AACH;AACJ,GAvCI;AAwCLiB,QAAK,cAASZ,OAAT,EAAmBL,IAAnB,EAAwB;AACzB,QAAIkB,QAAQ;AACRlB,YAAOA;AADC,KAAZ;AAGA,SAAKO,IAAL,CAAUF,OAAV,EAAoBa,KAApB;AACH,GA7CI;AA8CLC,cAAW,sBAAU,CAEpB,CAhDI;AAiDLlB,SAAM,eAASmB,MAAT,EAAgB;AAClB,WAAOL,KAAKd,KAAL,CAAWmB,MAAX,CAAP;AACH;AAnDI,CAAT","file":"socket.io.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\resources\\script\\lib","sourcesContent":["cc.Class({\r    extends: cc.Component,\r\r    properties: {\r\r    },\r\r    connect:function(url , options){\r        let self = this ;\r        this.ws = new WebSocket(url+\"?userid=\"+cc.beimi.user.id);\r        this.ws.onopen = function (event) {\r            console.log(\"Send Text WS was opened.\");\r        };\r        this.ws.onmessage = function (event) {\r            var data = self.parse(event.data) ;\r            if(data!=null && data.event != null){\r                cc.beimi.event[data.event](event.data);\r            }\r            console.log(\"response text msg: \" + event.data);\r        };\r        this.ws.onerror = function (event) {\r            console.log(\"Send Text fired an error\");\r        };\r        this.ws.onclose = function (event) {\r            console.log(\"WebSocket instance closed.\");\r        };\r        return this;\r    },\r    on:function(command , func){\r        cc.beimi.event[command] =  func ;\r    },\r    exec:function(command , data){\r        if (this.ws.readyState === WebSocket.OPEN) {\r            data.command = command;\r            data.userid = cc.beimi.user.id ;\r            data.orgi = cc.beimi.user.orgi ;\r            data.token = cc.beimi.authorization ;\r            this.ws.send(JSON.stringify(data));\r        }\r    },\r    emit:function(command , data){\r        let param = {\r            data : data\r        } ;\r        this.exec(command , param) ;\r    },\r    disconnect:function(){\r\r    },\r    parse:function(result){\r        return JSON.parse(result) ;\r    },\r});\r"]}