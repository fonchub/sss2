{"version":3,"sources":["HTTP.js"],"names":["cc","VERSION","HTTP","Class","extends","Component","properties","statics","baseURL","wsURL","authorization","httpGet","url","success","error","object","console","log","xhr","loader","getXMLHttpRequest","onreadystatechange","readyState","status","respone","responseText","token","beimi","indexOf","open","sys","isNative","setRequestHeader","ontimeout","event","onerror","timeout","send","encodeFormData","data","pairs","regexp","name","value","toString","pair","encodeURIComponent","replace","push","join","httpPost","params","onLoad"],"mappings":"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","file":"HTTP.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\resources\\script\\lib","sourcesContent":["cc.VERSION = 2017061001;\nvar HTTP = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n    },\n    statics: {\n        baseURL:\"http://localhost\",\n        wsURL : \"ws://localhost:8080\",\n        authorization: null,\n\n\n        httpGet: function (url , success , error , object) {\n            console.log(url+\"请求路径\"+success+\"成功状态下\"+error+\"失败状态下\"+object)\n            var xhr = cc.loader.getXMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if(xhr.status >= 200 && xhr.status < 300){\n                        var respone = xhr.responseText;\n                        if(success){\n                            success(respone , object);\n                        }\n                    }else{\n                        if(error){\n                            error(object);\n                        }\n                    }\n                }\n            };\n            let token = \"\" ;\n            if(cc.beimi!=null && cc.beimi.authorization != null){\n                token = cc.beimi.authorization ;\n            }\n            if(url.indexOf(\"?\") >0){\n                xhr.open(\"GET\", HTTP.baseURL+url+\"&authorization=\"+token , true);\n            }else{\n                xhr.open(\"GET\", HTTP.baseURL+url+\"?authorization=\"+token, true);\n            }\n\n            if (cc.sys.isNative) {\n                xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\n            }\n            //超时回调\n            xhr.ontimeout = function(event){\n                error(object);\n            };\n            xhr.onerror = function(event){\n                error(object);\n            };\n\n            // note: In Internet Explorer, the timeout property may be set only after calling the open()\n            // method and before calling the send() method.\n            xhr.timeout = 3000;// 5 seconds for timeout\n\n            xhr.send();\n        },\n\n\n        \n        encodeFormData : function(data)  \n        {  \n            var pairs = [];  \n            var regexp = /%20/g;  \n          \n            for (var name in data){  \n                var value = data[name].toString();  \n                var pair = encodeURIComponent(name).replace(regexp, \"+\") + \"=\" +  \n                    encodeURIComponent(value).replace(regexp, \"+\");  \n                pairs.push(pair);  \n            }  \n            return pairs.join(\"&\");  \n        },\n        httpPost: function (url, params, success , error , object) {\n            var xhr = cc.loader.getXMLHttpRequest();\n\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if(xhr.status >= 200 && xhr.status < 300){\n                        var respone = xhr.responseText;\n                        if(success){\n                            success(respone , object);\n                        }\n                    }else{\n                        if(error){\n                            error(object);\n                        }\n                    }\n                }\n            };\n            xhr.open(\"POST\", HTTP.baseURL+url, true);\n            if(cc.beimi!=null && cc.beimi.authorization != null){\n                xhr.setRequestHeader(\"authorization\", cc.beimi.authorization) ;\n            }\n            if (cc.sys.isNative) {\n                xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\n            }\n            xhr.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n    \n            // note: In Internet Explorer, the timeout property may be set only after calling the open()\n            // method and before calling the send() method.\n            xhr.timeout = 5000;// 5 seconds for timeout\n            \n            xhr.send( HTTP.encodeFormData(params));\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n    },\n\n    \n});"]}