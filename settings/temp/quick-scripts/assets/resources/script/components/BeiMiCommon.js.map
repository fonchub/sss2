{"version":3,"sources":["BeiMiCommon.js"],"names":["Base64","require","cc","Class","extends","Component","properties","onLoad","beimi","room_callback","ready","check","scene","connect","self","socket","disconnect","window","io","http","wsURL","game","on","EVENT_HIDE","event","EVENT_SHOW","console","log","data","param","token","authorization","orgi","user","userid","id","exec","result","parse","extparams","gamestatus","gametype","playway","cardroom","gamemodel","sessiontimeout","alert","registercallback","callback","cleancallback","getCommon","common","object","find","getComponent","loadding","size","loaddingDialog","get","parent","_animCtrl","Animation","animState","play","wrapMode","WrapMode","Loop","message","alertForCallBack","func","dialog","alertdialog","node","getChildByName","Label","string","temp","closeloadding","put","closeOpenWin","openwin","destroy","openWin","prefab","instantiate","root","pvalistener","context","listener","cleanpvalistener","pva","pvatype","balance","goldcoins","cards","diamonds","updatepva","subsidy","needsubsidy","subtimes","subgolds","lefttimes","tipmsg","submsg","welfareDialog","recmsg","shopDialog","loader","loadRes","err","resize","win","director","getWinSize","view","setDesignResolutionSize","width","height","ResolutionPolicy","EXACT_FIT","closealert","name","preloadScene","loadScene","preload","decode","JSON","reset","games","logout","map","command","routes","cleanmap","p","route","layout","target","Array","children","inx","length","push","removeChild","sort","splice"],"mappings":"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","file":"BeiMiCommon.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\resources\\script\\components","sourcesContent":["var Base64 = require(\"Base64\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        cc.beimi.room_callback = null ;  //加入房间回调函数\n    },\n    ready:function(){\n        var check = false ;\n        if(cc.beimi){\n            check = true ;\n        }else{\n            this.scene(\"login\" , this) ;\n        }\n        return check ;\n    },\n    connect:function(){\n        let self = this ;\n        /**\n         * 登录成功后，创建 Socket链接，\n         */\n        if(cc.beimi.socket != null){\n            cc.beimi.socket.disconnect();\n            cc.beimi.socket = null ;\n        }\n        cc.beimi.socket = window.io.connect(cc.beimi.http.wsURL + '/bm/game',{\"reconnection\":true});\n\n\n        cc.game.on(cc.game.EVENT_HIDE, function(event) {\n            //self.alert(\"HIDE TRUE\");\n        });\n        cc.game.on(cc.game.EVENT_SHOW, function(event) {\n            console.log(\"SHOW TRUE\");\n            //self.alert(\"SHOW TRUE\");\n        });\n\n        cc.beimi.socket.on('connect', function (data) {\n            console.log(\"connected to server\");\n            //self.alert(\"connected to server\");\n        });\n\n        cc.beimi.socket.on('disconnect', function (data) {\n            console.log(\"disconnected from server\");\n            //self.alert(\"disconnected from server\");\n\n        });\n        var param = {\n            token:cc.beimi.authorization,\n            orgi:cc.beimi.user.orgi,\n            userid:cc.beimi.user.id\n        } ;\n        cc.beimi.socket.exec(\"gamestatus\" , param);\n        cc.beimi.socket.on(\"gamestatus\" , function(result){\n            if(result!=null) {\n                var data = self.parse(result) ;\n                if(cc.beimi.extparams !=null){\n                    if(data.gamestatus == \"playing\" && data.gametype != null){\n                        /**\n                         * 修正重新进入房间后 玩法被覆盖的问题，从服务端发送过来的 玩法数据是 当前玩家所在房间的玩法，是准确的\n                         */\n                        if(cc.beimi.extparams!=null){\n                            cc.beimi.extparams.playway = data.playway ;\n                            cc.beimi.extparams.gametype = data.gametype ;\n                            if(data.cardroom!=null && data.cardroom == true){\n                                cc.beimi.extparams.gamemodel = \"room\";\n                            }\n                        }\n                        self.scene(data.gametype , self) ;\n                    }else if(data.gamestatus == \"timeout\"){ //会话过期，退出登录 ， 会话时间由后台容器提供控制\n                        cc.beimi.sessiontimeout = true ;\n                        self.alert(\"登录已过期，请重新登录\") ;\n                    }else{\n                        self.scene(cc.beimi.extparams.gametype , self) ;\n                    }\n                }\n                cc.beimi.gamestatus = data.gamestatus;\n            }\n        });\n\n\n        /**\n         * 加入房卡模式的游戏类型 ， 需要校验是否是服务端发送的消息\n         */\n        cc.beimi.socket.on(\"searchroom\" , function(result){\n            //result 是 GamePlayway数据，如果找到了 房间数据，则进入房间，如果未找到房间数据，则提示房间不存在\n            if(result!=null && cc.beimi.room_callback!=null) {\n                cc.beimi.room_callback(result , self);\n            }\n        });\n        return cc.beimi.socket ;\n    },\n    disconnect:function(){\n        if(cc.beimi.socket != null){\n            cc.beimi.socket.disconnect();\n            cc.beimi.socket = null ;\n        }\n    },\n    registercallback:function(callback){\n        cc.beimi.room_callback = callback ;\n    },\n    cleancallback:function(){\n        cc.beimi.room_callback = null ;\n    },\n    getCommon:function(common){\n                       //查找结点\n        var object = cc.find(\"Canvas/script/\"+common) ;\n                     //获取节点上的组件\n        return object.getComponent(common);\n    },\n    loadding:function(){\n        if(cc.beimi.loadding.size() > 0){\n            this.loaddingDialog = cc.beimi.loadding.get();\n            this.loaddingDialog.parent = cc.find(\"Canvas\");\n\n            this._animCtrl = this.loaddingDialog.getComponent(cc.Animation);\n            var animState = this._animCtrl.play(\"loadding\");\n            animState.wrapMode = cc.WrapMode.Loop;\n        }\n    },\n    alert:function(message){\n        this.alertForCallBack(message , null);\n    },\n    alertForCallBack:function(message , func){\n        if(cc.beimi.dialog.size() > 0){\n            this.alertdialog = cc.beimi.dialog.get();\n            this.alertdialog.parent = cc.find(\"Canvas\");\n            let node = this.alertdialog.getChildByName(\"message\") ;\n            if(node!=null && node.getComponent(cc.Label)){\n                node.getComponent(cc.Label).string = message ;\n            }\n            if(func!=null){\n                let temp = this.alertdialog.getComponent(\"BeiMiDialog\") ;\n                if(temp!=null){\n                    temp.callback(func);\n                }\n            }\n        }\n        this.closeloadding();\n    },\n    closeloadding:function(){\n        //按照路径查找节点，即使节点处于非活动状态，该函数仍然会返回该节点\n        if(cc.find(\"Canvas/loadding\")){\n            //\n            cc.beimi.loadding.put(cc.find(\"Canvas/loadding\"));\n        }\n    },\n    closeOpenWin:function(){\n        if(cc.beimi.openwin != null){\n            //销毁该对象，并释放所有它对其它对象的引用。\n            cc.beimi.openwin.destroy();\n            cc.beimi.openwin = null ;\n        }\n    },\n    openWin:function(prefab){\n        if(prefab!=null){\n            cc.beimi.openwin = cc.instantiate(prefab) ;\n            cc.beimi.openwin.parent = this.root();\n        }\n    },\n    pvalistener:function(context , func){\n        cc.beimi.listener = func ;\n        cc.beimi.context = context ;\n    },\n    cleanpvalistener:function(){\n        if(cc.beimi != null){\n            cc.beimi.listener = null ;\n            cc.beimi.context = null ;\n        }\n    },\n    pva:function(pvatype , balance){   //客户端资产变更（仅显示，多个地方都会调用 pva方法）\n        if(pvatype != null){\n            if(pvatype == \"gold\"){\n                cc.beimi.user.goldcoins = balance ;\n            }else if(pvatype == \"cards\"){\n                cc.beimi.user.cards = balance ;\n            }else if(pvatype == \"diamonds\"){\n                cc.beimi.user.diamonds = balance ;\n            }\n        }\n    },\n    updatepva:function(){\n        if(cc.beimi!=null && cc.beimi.listener != null && cc.beimi.context != null){\n            cc.beimi.listener(cc.beimi.context);\n        }\n    },\n    subsidy:function(){\n        var needsubsidy = false ;\n        if(cc.beimi.user.goldcoins <= 0){\n            let self = this ;\n            needsubsidy = true ;\n            //提示是否需要破产补助 , 提示的时候，需要查询服务端是否当天的 补助次数已用完，如果还有剩余补助次数，则开始补助，否则直接进入商城提示兑换 ， 剩余的补助次数，在服务器推送 PVA信息的时候，同时推送过来\n            if(cc.beimi.data.subsidy == true && cc.beimi.data.subtimes > 0 && cc.beimi.data.subgolds > 0 && cc.beimi.data.lefttimes >0){\n                // cc.loader.loadRes(\"prefab/welfare/over\", function (err, prefab) {\n                //     cc.beimi.openwin = cc.instantiate(prefab);\n                //     cc.beimi.openwin.parent = cc.beimi.context.root();\n                // });\n                let tipmsg = \"金币不足，您可以领取救济金。\";\n                if(cc.beimi.data.submsg != null){\n                    tipmsg = cc.beimi.data.submsg  ;\n                }\n                this.alertForCallBack( tipmsg, function(){\n                    self.welfareDialog();\n                });\n            }else{\n                let recmsg = \"金币不足，请充值。\" ;\n                if(cc.beimi.data.recmsg != null){\n                    recmsg = cc.beimi.data.recmsg  ;\n                }\n                this.alertForCallBack(recmsg , function(){\n                    self.shopDialog();\n                });\n            }\n        }\n        return needsubsidy ;\n    },\n    welfareDialog:function(){\n        cc.loader.loadRes(\"prefab/welfare/over\", function (err, prefab) {\n            cc.beimi.openwin = cc.instantiate(prefab);\n            cc.beimi.openwin.parent = cc.beimi.context.root();\n        });\n    },\n    shopDialog:function(){\n        cc.loader.loadRes(\"prefab/welfare/shop\", function (err, prefab) {\n            cc.beimi.openwin = cc.instantiate(prefab);\n            cc.beimi.openwin.parent = cc.beimi.context.root();\n        });\n    },\n    resize:function(){\n        let win = cc.director.getWinSize() ;\n        cc.view.setDesignResolutionSize(win.width, win.height, cc.ResolutionPolicy.EXACT_FIT);\n    },\n    closealert:function(){\n        if(cc.find(\"Canvas/alert\")){\n            cc.beimi.dialog.put(cc.find(\"Canvas/alert\"));\n        }\n    },\n    //加载场景\n    scene:function(name , self){\n        //预加载场景，可以随时用cc.director.loadScene来启动场景\n        cc.director.preloadScene(name, function () {\n            if(cc.beimi){\n                self.closeloadding(self.loaddingDialog);\n            }\n            cc.director.loadScene(name);\n        });\n    },\n    preload:function(extparams , self){\n        this.loadding();\n        /**\n         *切换游戏场景之前，需要先检查是否 是在游戏中，如果是在游戏中，则直接进入该游戏，如果不在游戏中，则执行 新场景游戏\n         */\n        cc.beimi.extparams = extparams ;\n        /**\n         * 发送状态查询请求，如果玩家当前在游戏中，则直接进入游戏回复状态，如果玩家不在游戏中，则创建新游戏场景\n         */\n        var param = {\n            token:cc.beimi.authorization,\n            orgi:cc.beimi.user.orgi,\n            userid:cc.beimi.user.id\n        } ;\n        cc.beimi.socket.exec(\"gamestatus\" , param);\n    },\n    root:function(){\n        //查找Canvas节点\n        return cc.find(\"Canvas\");\n    },\n    decode:function(data){\n\n        return Base64.decode(data) ;\n    },\n    parse:function(result){\n        return JSON.parse(result) ;\n    },\n    reset:function(data , result){\n        //放在全局变量\n        cc.beimi.authorization = data.token.id ;\n        cc.beimi.user = data.data ;\n        cc.beimi.games = data.games ;\n        cc.beimi.gametype = data.gametype ;\n\n        cc.beimi.data = data ;\n        cc.beimi.playway = null ;\n        this.io.put(\"token\" ,data.token.id);\n    },\n    logout:function(){\n        this.closeOpenWin();\n        cc.beimi.authorization = null ;\n        cc.beimi.user = null ;\n        cc.beimi.games = null ;\n\n        cc.beimi.playway = null ;\n\n        this.disconnect();\n    },\n    socket:function(){\n        let socket = cc.beimi.socket ;\n        if(socket == null){\n            socket = this.connect();\n        }\n        return socket ;\n    },\n    map:function(command, callback){\n        if(cc.beimi!=null && cc.beimi.routes[command] == null){\n            cc.beimi.routes[command] = callback || function(){};\n        }\n    },\n    cleanmap:function(){\n        if(cc.beimi!=null && cc.beimi.routes != null){\n            //cc.beimi.routes.splice(0 , cc.beimi.routes.length) ;\n            for(var p in cc.beimi.routes){\n                delete cc.beimi.routes[p];\n            }\n        }\n    },\n    route:function(command){\n        return cc.beimi.routes[command] || function(){};\n    },\n    /**\n     * 解决Layout的渲染顺序和显示顺序不一致的问题\n     * @param target\n     * @param func\n     */\n    layout:function(target , func){\n        if(target != null){\n            let temp = new Array() ;\n            let children = target.children ;\n            for(var inx = 0 ; inx < children.length ; inx++){\n                temp.push(children[inx]) ;\n            }\n            for(var inx = 0 ; inx < temp.length ; inx++){\n                target.removeChild(temp[inx]) ;\n            }\n\n            temp.sort(func) ;\n            for(var inx =0 ; inx<temp.length ; inx++){\n                temp[inx].parent = target ;\n            }\n            temp.splice(0 , temp.length) ;\n        }\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}