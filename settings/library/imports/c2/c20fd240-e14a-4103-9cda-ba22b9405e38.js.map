{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\module\\login\\script/assets\\module\\login\\script\\common.js"],"names":["beiMiCommon","require","cc","Class","extends","onLoad","login","io","loadding","get","xhr","beimi","http","httpGet","sucess","error","console","log","data","JSON","parse","token","id","result","object","reset","gamestatus","connect","gametype","scene","closeloadding","loaddingDialog","alert"],"mappings":";;;;;;AAAA,IAAIA,cAAcC,QAAQ,aAAR,CAAlB;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASJ,WADJ;;AAGL;AACAK,YAAQ,kBAAY,CAEnB,CANI;AAOLC,WAAM,iBAAU;AACZ,aAAKC,EAAL,GAAUN,QAAQ,SAAR,CAAV;AACA,aAAKO,QAAL;AACA,YAAG,KAAKD,EAAL,CAAQE,GAAR,CAAY,UAAZ,KAA2B,IAA9B,EAAmC;AAChC;AACC,gBAAIC,MAAMR,GAAGS,KAAH,CAASC,IAAT,CAAcC,OAAd,CAAsB,YAAtB,EAAoC,KAAKC,MAAzC,EAAkD,KAAKC,KAAvD,EAA+D,IAA/D,CAAV;AACAC,oBAAQC,GAAR,CAAYP,GAAZ;AACA;AACH,SALD,MAKK;AACD;AACA,gBAAIQ,OAAOC,KAAKC,KAAL,CAAW,KAAKb,EAAL,CAAQE,GAAR,CAAY,UAAZ,CAAX,CAAX;AACA,gBAAGS,KAAKG,KAAL,IAAc,IAAjB,EAAsB;AAAM;AACxB,oBAAIX,MAAMR,GAAGS,KAAH,CAASC,IAAT,CAAcC,OAAd,CAAsB,sBAAoBK,KAAKG,KAAL,CAAWC,EAArD,EAAyD,KAAKR,MAA9D,EAAuE,KAAKC,KAA5E,EAAoF,IAApF,CAAV;AAEH;AACJ;AACP,KAvBO;AAwBLD,YAAO,gBAASS,MAAT,EAAkBC,MAAlB,EAAyB;AAC5B,YAAIN,OAAOC,KAAKC,KAAL,CAAWG,MAAX,CAAX;AACAP,gBAAQC,GAAR,CAAYC,OAAK,QAAjB;AACAF,gBAAQC,GAAR,CAAYO,SAAO,eAAnB;AACA,YAAGN,QAAM,IAAN,IAAcA,KAAKG,KAAL,IAAY,IAA1B,IAAkCH,KAAKA,IAAL,IAAW,IAAhD,EAAqD;AACjD;AACAM,mBAAOC,KAAP,CAAaP,IAAb,EAAoBK,MAApB;AACArB,eAAGS,KAAH,CAASe,UAAT,GAAsBR,KAAKA,IAAL,CAAUQ,UAAhC;AACA;;;AAGAF,mBAAOG,OAAP;AACA;AACA,gBAAGzB,GAAGS,KAAH,CAASiB,QAAT,IAAmB,IAAnB,IAA2B1B,GAAGS,KAAH,CAASiB,QAAT,IAAqB,EAAnD,EAAsD;AAAC;AACnDJ,uBAAOK,KAAP,CAAa3B,GAAGS,KAAH,CAASiB,QAAtB,EAAiCJ,MAAjC;AACH,aAFD,MAEK;AACD;;;AAGH;AACJ;AACJ,KA7CI;AA8CLT,WAAM,eAASS,MAAT,EAAgB;AAClBA,eAAOM,aAAP,CAAqBN,OAAOO,cAA5B;AACAP,eAAOQ,KAAP,CAAa,aAAb;AACH;;AAED;AACA;;AAEA;AAtDK,CAAT","file":"common.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\module\\login\\script","sourcesContent":["var beiMiCommon = require(\"BeiMiCommon\");\ncc.Class({\n    extends: beiMiCommon,\n\n    // use this for initialization\n    onLoad: function () {\n\n    },\n    login:function(){\n        this.io = require(\"IOUtils\");\n        this.loadding();\n        if(this.io.get(\"userinfo\") == null){\n           //发送游客注册请求\n            var xhr = cc.beimi.http.httpGet(\"/api/guest\", this.sucess , this.error , this);\n            console.log(xhr);\n            // object.alert(xhr);\n        }else{\n            //通过ID获取 玩家信息\n            var data = JSON.parse(this.io.get(\"userinfo\")) ;\n            if(data.token != null){     //获取用户登录信息\n                var xhr = cc.beimi.http.httpGet(\"/api/guest?token=\"+data.token.id, this.sucess , this.error , this);       \n               \n            }\n        }\n\t},\n    sucess:function(result , object){\n        var data = JSON.parse(result) ;\n        console.log(data+\"成功后的参数\")\n        console.log(object+\"这个说实话我也不知道是什么\")\n        if(data!=null && data.token!=null && data.data!=null){\n            //放在全局变量\n            object.reset(data , result);\n            cc.beimi.gamestatus = data.data.gamestatus ;\n            /**\n             * 登录成功后即创建Socket链接\n             */\n            object.connect();\n            //预加载场景\n            if(cc.beimi.gametype!=null && cc.beimi.gametype != \"\"){//只定义了单一游戏类型 ，否则 进入游戏大厅\n                object.scene(cc.beimi.gametype , object) ;\n            }else{\n                /**\n                 * 暂未实现功能\n                 */\n            }\n        } \n    },\n    error:function(object){\n        object.closeloadding(object.loaddingDialog);\n        object.alert(\"网络异常，服务访问失败\");\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}