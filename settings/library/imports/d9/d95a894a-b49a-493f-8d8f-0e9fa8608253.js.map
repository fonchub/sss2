{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\module\\game\\majiang\\script/assets\\module\\game\\majiang\\script\\MajiangDataBind.js"],"names":["beiMiCommon","require","cc","Class","extends","properties","playerprefab","default","type","Prefab","statebtn","Node","mjtimer","Label","desk_tip","desk_cards","cards_current","cards_panel","one_card_panel","left_panel","right_panel","top_panel","cards_left","cards_right","cards_top","takecards_one","takecards_left","takecards_right","deskcards_current_panel","deskcards_right_panel","deskcards_top_panel","deskcards_left_panel","searchlight","actionnode_two","actionnode_two_list","actionnode_three","actionnode_three_list","actionnode_deal","action_gang_ming_prefab","action_gang_an_prefab","cards_gang_ming_prefab","cards_gang_an_prefab","roomid","gang_current","summary","inviteplayer","hu_cards_current","hu_cards_top","hu_cards_left","hu_cards_right","mask","onLoad","initdata","resize","self","active","ready","socket","routes","playersarray","Array","playercards","leftcards","rightcards","topcards","deskcards","actioncards","inited","centertimer","summarypage","exchange_state","node","on","event","card","target","getComponent","card_script","emit","value","stopPropagation","dealActionProcess","beimi","gamestatus","recovery","extparams","gamemodel","invite","instantiate","initgame","map","joinroom_event","players_event","banker_event","play_event","selectcolor_event","selectresult_event","lasthands_event","takecard_event","action_event","selectaction_event","dealcard_event","allcards_event","recovery_event","roomready_event","playeready_event","result","data","parse","route","command","param","token","authorization","playway","orgi","user","exec","initplayer","playerspool","NodePool","i","put","cardpool","context","cardroom","script","init","parent","root","string","player","get","playerscript","inx","tablepos","id","setPosition","index","push","destroy","userid","length","handcards","zIndex","reinit","splice","desk_card","temp","relastone","selectcolor","layout","fir","sec","cardpanel","cardprefab","deskcardpanel","children","right_temp","left_temp","top_temp","desk_script","recover_desk_cards","select_action_searchlight","initDealHandCards","initPlayerHandCards","action","exchange_searchlight","gameover","setTimeout","create","gameRoomOver","recoverboard","setAction","collect","pos","playerexist","inroom","j","banker","mycards","decode","cards","userboard","cardsnum","hiscards","gang","peng","chi","hu","guo","deal","name","actionNum","posx","actionevent","moveTo","easing","easeIn","runAction","rightpre","toppre","leftpre","hu_card","setScale","cardtype","mjtype","cardvalue","mjvalue","cards_gang","actype","temp_script","lastone","temp_player","calcdesc_cards","groupNums","times","initMjCards","players","playuser","ani","Animation","play","maxvalue","maxvalluecard","selecting","selectresult","color","changecolor","lastcard","parseInt","selected","start","end","spec","cardarray","prefab","initOtherCards","group","cardsarray","waittingForPlayers","pid","state","object","readybtn","waitting","selectbtn","enableai","timer","waittime","noaiwaitime","canceltimer","clean","direction","unscheduleAllCallbacks","callback","text","schedule","restart","startgame","onDestroy","cleanmap"],"mappings":"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","file":"MajiangDataBind.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\module\\game\\majiang\\script","sourcesContent":["var beiMiCommon = require(\"BeiMiCommon\");\n\ncc.Class({\n    extends: beiMiCommon,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        playerprefab:{\n            default : null ,\n            type : cc.Prefab\n        },\n        statebtn:{\n            default : null ,\n            type : cc.Node\n        },\n        mjtimer:{\n            default:null ,\n            type:cc.Label\n        },\n        desk_tip:{\n            default:null ,\n            type : cc.Node\n        },\n        desk_cards:{\n            default:null ,\n            type : cc.Label\n        },\n        cards_current:{\n            default:null ,\n            type : cc.Prefab\n        },\n        cards_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        one_card_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        left_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        right_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        top_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        cards_left:{\n            default:null ,\n            type : cc.Prefab\n        },\n        cards_right:{\n            default:null ,\n            type : cc.Prefab\n        },\n        cards_top:{\n            default:null ,\n            type : cc.Prefab\n        },\n        takecards_one:{         //我的和 对家出的牌\n            default:null ,\n            type : cc.Prefab\n        },\n        takecards_left:{\n            default:null ,\n            type : cc.Prefab\n        },\n        takecards_right:{\n            default:null ,\n            type : cc.Prefab\n        },\n        deskcards_current_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        deskcards_right_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        deskcards_top_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        deskcards_left_panel:{\n            default:null ,\n            type : cc.Node\n        },\n        searchlight:{\n            default:null ,\n            type : cc.Node\n        },\n        actionnode_two:{        //动作节点\n            default:null ,\n            type : cc.Node\n        },\n        actionnode_two_list:{        //动作节点\n            default:null ,\n            type : cc.Node\n        },\n        actionnode_three:{      //动作节点\n            default:null ,\n            type : cc.Node\n        },\n        actionnode_three_list:{      //动作节点\n            default:null ,\n            type : cc.Node\n        },\n        actionnode_deal:{      //动作节点\n            default:null ,\n            type : cc.Node\n        },\n        action_gang_ming_prefab:{\n            default:null ,\n            type : cc.Prefab\n        },\n        action_gang_an_prefab:{\n            default:null ,\n            type : cc.Prefab\n        },\n        cards_gang_ming_prefab:{\n            default:null ,\n            type : cc.Prefab\n        },\n        cards_gang_an_prefab:{\n            default:null ,\n            type : cc.Prefab\n        },\n        roomid:{\n            default : null ,\n            type : cc.Label\n        },\n        gang_current:{        //动作节点\n            default:null ,\n            type : cc.Node\n        },\n        summary:{\n            default:null ,\n            type : cc.Prefab\n        },\n        inviteplayer:{\n            default:null ,\n            type : cc.Prefab\n        },\n        hu_cards_current:{\n            default:null ,\n            type : cc.Node\n        },\n        hu_cards_top:{\n            default:null ,\n            type : cc.Node\n        },\n        hu_cards_left:{\n            default:null ,\n            type : cc.Node\n        },\n        hu_cards_right:{\n            default:null ,\n            type : cc.Node\n        },\n        mask:{\n            default:null ,\n            type : cc.Node\n        }\n    },\n\n    // use this for initialization\n    /**\n     * 重构后，只有两个消息类型\n     */\n    onLoad: function () {\n        this.initdata(true);\n        this.resize();\n        let self = this ;\n        if(this.mask != null){\n            this.mask.active = false ;\n        }\n        if(this.ready()) {\n            let socket = this.socket();\n            this.routes = {};\n            /**\n             * 已初始的玩家对象池 ， 牌局结束 或者 有新玩家加入， 老玩家离开 等事件的时候，需要做对象池回收\n             * @type {Array}\n             */\n            this.playersarray = new Array();        //玩家列表\n\n            this.playercards = new Array();         //手牌对象\n\n            this.leftcards = new Array();           //左侧玩家手牌\n            this.rightcards = new Array();          //右侧玩家手牌\n            this.topcards = new Array();           //对家手牌\n\n            this.deskcards = new Array();           //当前玩家和 对家 已出牌\n\n            this.actioncards = new Array();           //当前玩家和 对家 已出牌\n\n            this.inited = false;\n\n            this.centertimer = null;\n\n            this.summarypage = null ;\n\n\n            this.exchange_state(\"init\", this);\n\n            /**\n             * 发射的事件， 在 出牌双击 / 滑动出牌的时候发射的，此处用于接受后统一处理， 避免高度耦合\n             * 之所以这样设计，是因为在TakeMJCard里需要引用 麻将牌的 对象池 和 出牌的对象池，如果采用对象传入或者 通过find获取的方式处理\n             * 则会导致高度的 组件耦合，不利于系统 未来扩展，也会导致 业务逻辑交叉/混乱\n             * 无论 胡牌/杠/碰/吃，都需要采用这种方式处理\n             */\n            this.node.on('takecard', function (event) {\n                let card = event.target.getComponent(\"TakeMJCard\");\n                if (card != null) {\n                    let card_script = card.target.getComponent(\"HandCards\");\n                    /**\n                     * 提交数据，等待服务器返回\n                     */\n                        //开始匹配\n\n                    socket.emit(\"doplaycards\", card_script.value);\n                }\n                event.stopPropagation();\n            });\n            /**\n             * ActionEvent发射的事件 ， 点击 杠 , 通知服务器端，用户点击了 杠 动作，服务器端进行处理，处理完毕后通知客户端后续动作\n             */\n            this.node.on(\"gang\", function (event) {\n                self.dealActionProcess(self);\n                socket.emit(\"selectaction\", \"gang\");\n\n                event.stopPropagation();\n            });\n            /**\n             * ActionEvent发射的事件 ， 点击 碰\n             */\n            this.node.on(\"peng\", function (event) {\n                self.dealActionProcess(self);\n                socket.emit(\"selectaction\", \"peng\");\n\n                event.stopPropagation();\n            });\n            /**\n             * ActionEvent发射的事件 ， 点击 吃\n             */\n            this.node.on(\"chi\", function (event) {\n                self.dealActionProcess(self);\n                socket.emit(\"selectaction\", \"chi\");\n                event.stopPropagation();\n            });\n            /**\n             * ActionEvent发射的事件 ， 点击 胡\n             */\n            this.node.on(\"hu\", function (event) {\n                self.dealActionProcess(self);\n                socket.emit(\"selectaction\", \"hu\");\n                event.stopPropagation();\n            });\n            /**\n             * ActionEvent发射的事件 ， 点击 过\n             */\n            this.node.on(\"guo\", function (event) {\n                self.dealActionProcess(self);\n                socket.emit(\"selectaction\", \"guo\");\n\n                event.stopPropagation();\n            });\n\n            if(cc.beimi!=null){\n                if(cc.beimi.gamestatus!=null && cc.beimi.gamestatus == \"playing\"){\n                    //恢复数据\n                    this.recovery() ;\n                }else if(cc.beimi.extparams!=null && cc.beimi.extparams.gamemodel == \"room\"){\n                    /**\n                     * 房卡模式，开始启动游戏，当前玩家进入等待游戏的状态，显示邀请好友游戏，并分配 6位数字的房间号码\n                     */\n                    /**\n                     * 处理完毕，清理掉全局变量\n                     * @type {null}\n                     */\n                    this.invite = cc.instantiate(this.inviteplayer) ;\n                }\n                this.initgame();\n            }\n        }\n    },\n    initgame:function(){\n        let self = this ;\n        if(this.ready()){\n            let socket = this.socket();\n            /**\n             * 接受指令\n             */\n\n            this.map(\"joinroom\" , this.joinroom_event) ;          //加入房价\n            this.map(\"players\" , this.players_event) ;            //接受玩家列表\n\n            this.map(\"banker\" , this.banker_event) ;          //庄家\n\n            this.map(\"play\" , this.play_event) ;          //人齐了，接收发牌信息\n\n            this.map(\"selectcolor\" , this.selectcolor_event) ;          //从服务端发送的 定缺的 指令，如果服务端玩法里不包含定缺， 可以不发送这个指令而是直接开始打牌\n\n            this.map(\"selectresult\" , this.selectresult_event) ;          //从服务端发送的 定缺的 指令，如果服务端玩法里不包含定缺， 可以不发送这个指令而是直接开始打牌\n\n            this.map(\"lasthands\" , this.lasthands_event) ;              //庄家开始打牌了，允许出牌\n\n            this.map(\"takecards\" , this.takecard_event) ;                //我出的牌\n\n            this.map(\"action\" , this.action_event) ;                     //服务端发送的 动作事件，有杠碰吃胡过可以选择\n\n            this.map(\"selectaction\" , this.selectaction_event) ;        //我选择的动作， 杠碰吃胡\n\n            this.map(\"dealcard\" , this.dealcard_event) ;                //我出的牌\n\n            this.map(\"allcards\" , this.allcards_event) ;                //我出的牌\n\n            this.map(\"recovery\" , this.recovery_event) ;              //恢复牌局数据\n\n            this.map(\"roomready\" , this.roomready_event) ;              //提示\n\n            this.map(\"playeready\" , this.playeready_event) ;            //玩家点击了开始游戏 ， 即准备就绪\n\n            socket.on(\"command\" , function(result){\n                cc.beimi.gamestatus = \"playing\" ;\n                if(self.inited == true){\n                    var data = self.parse(result) ;\n                    self.route(data.command)(data , self);\n                }\n            });\n\n            var param = {\n                token:cc.beimi.authorization,\n                playway:cc.beimi.extparams.playway,\n                orgi:cc.beimi.user.orgi,\n                extparams:cc.beimi.extparams\n            } ;\n            socket.exec(\"joinroom\" ,param) ;\n\n            this.inited = true ;\n        }\n    },\n    initdata:function(initplayer){\n        /**\n         * 适配屏幕尺寸\n         */\n\n        if(initplayer == true){\n            /**\n             * 预制的 对象池\n             * @type {cc.NodePool}\n             */\n            this.playerspool = new cc.NodePool();\n            /**\n             *\n             * 初始化玩家 的 对象池\n             */\n            for (var i = 0; i < 4; i++) {\n                this.playerspool.put(cc.instantiate(this.playerprefab));\n            }\n        }\n\n        /**\n         * 当前玩家的 麻将牌的 对象池\n         * @type {cc.NodePool}\n         */\n        this.cardpool = new cc.NodePool();\n        /**\n         * 初始化当前玩家的麻将牌 对象池\n         */\n        for (var i = 0; i < 14; i++) {\n            this.cardpool.put(cc.instantiate(this.cards_current));\n        }\n    },\n    /**\n     * 新创建牌局，首个玩家加入，进入等待状态，等待其他玩家加入，服务端会推送 players数据\n     * @param data\n     * @param context\n     */\n    joinroom_event:function(data , context){\n        if(data.cardroom == true && context.inviteplayer!=null){\n            let script = context.invite.getComponent(\"BeiMiQR\")\n            script.init(data.roomid);\n            context.invite.parent = context.root() ;\n\n            if(context.roomid != null){\n                context.roomid.string = data.roomid ;\n            }\n        }else{\n            if(context.roomid != null){\n                context.roomid.string = \"大厅房间\" ;\n            }\n        }\n\n        var player = context.playerspool.get();\n        var playerscript = player.getComponent(\"MaJiangPlayer\");\n        //var playerscript = player.getComponent(\"MaJiangPlayer\");\n        var inx = null , tablepos = \"\";\n        if(data.player.id == cc.beimi.user.id){\n            player.setPosition(-570 , -150);\n            tablepos = \"current\" ;\n            context.index = data.index ;\n        }else{\n            inx = data.index - context.index ;\n            if(inx == 1){\n                //var playerscript = player.getComponent(\"MaJiangPlayer\");\n                player.setPosition(570 , 50);\n                tablepos = \"right\" ;\n            }else if(inx == 2){\n                //var playerscript = player.getComponent(\"MaJiangPlayer\");\n                player.setPosition(400 , 300);\n                tablepos = \"top\" ;\n            }else if(inx == 3){\n                //var playerscript = player.getComponent(\"MaJiangPlayer\");\n                player.setPosition(-570 , 50);\n                tablepos = \"left\" ;\n            }\n        }\n\n\n        playerscript.init(data.player , inx , tablepos);\n        player.parent = context.root();\n        context.playersarray.push(player) ;\n        /**\n         * 初始化状态，首个玩家加入，然后开始等待其他玩家 ， 如果是 恢复数据， 则不会进入\n         */\n        //this.statusbtn.active = true ;\n    },\n    /**\n     * 房卡模式下，邀请的好友人到齐了\n     * @param data\n     * @param context\n     */\n    roomready_event:function(data , context){\n        if(context.invite!=null){\n            context.invite.destroy();\n        }\n    },\n    /**\n     *\n     * @param data\n     * @param context\n     */\n    playeready_event:function(data , context){\n        if(data.userid == cc.beimi.user.id){\n            context.exchange_state(\"ready\" , context);\n        }\n    },\n    /**\n     * 新创建牌局，首个玩家加入，进入等待状态，等待其他玩家加入，服务端会推送 players数据\n     * @param data\n     * @param context\n     */\n    takecard_event:function(data , context){\n        if(data.userid == cc.beimi.user.id) {\n            for (var inx = 0; inx < context.playercards.length; ) {\n                let handcards = context.playercards[inx].getComponent(\"HandCards\");\n                if (data.card == handcards.value) {\n\n                    context.playercards[inx].zIndex = 0 ;\n                    /**\n                     * 从数组中移除\n                     */\n                    context.playercards[inx].parent = null;\n\n                    handcards.reinit();\n                    /**\n                     * 还回 对象池\n                     */\n                    context.cardpool.put(context.playercards[inx]);\n\n                    /**\n                     * 从数组中移除\n                     */\n                    context.playercards.splice(inx, 1);\n\n                    /**\n                     * 放到桌面 ， 需要重构\n                     */\n                    let desk_card = cc.instantiate(context.takecards_one);\n                    let temp = desk_card.getComponent(\"DeskCards\");\n                    temp.init(handcards.value);\n\n                    context.deskcards.push(desk_card);\n                    desk_card.parent = context.deskcards_current_panel;\n                }else{\n                    handcards.relastone();\n                    if(handcards.selectcolor == true){\n                        context.playercards[inx].zIndex = 1000 + handcards.value ;\n                    }else{\n                        if(handcards.value >= 0){\n                            context.playercards[inx].zIndex = handcards.value ;\n                        }else{\n                            context.playercards[inx].zIndex = 200 + handcards.value ;\n                        }\n                    }\n                    inx = inx + 1 ;     //遍历 ++,不处理移除的 牌\n                }\n            }\n            /**\n             * 重新排序\n             */\n            context.layout(context.cards_panel,function(fir ,sec){\n                return fir.zIndex - sec.zIndex ;\n            });\n            context.exchange_state(\"takecard\" , context);  //隐藏 提示状态\n        }else{\n            //其他玩家出牌\n            let temp = context.player(data.userid , context) ;\n            let cardpanel  , cardprefab , deskcardpanel;\n            if(temp.tablepos == \"right\"){\n                for(var inx = 0 ; inx < context.right_panel.children.length ; inx++){\n                    let right_temp = context.right_panel.children[inx].getComponent(\"SpecCards\");\n                    right_temp.reinit();\n                }\n\n                cardpanel = context.right_panel ;\n                cardprefab = context.takecards_right ;\n                deskcardpanel = context.deskcards_right_panel ;\n\n            }else if(temp.tablepos == \"left\"){\n                for(var inx = 0 ; inx < context.left_panel.children.length ; inx++){\n                    let left_temp = context.left_panel.children[inx].getComponent(\"SpecCards\");\n                    left_temp.reinit();\n                }\n\n                cardpanel = context.left_panel ;\n                cardprefab = context.takecards_left ;\n                deskcardpanel = context.deskcards_left_panel ;\n            }else if(temp.tablepos == \"top\"){\n                for(var inx = 0 ; inx < context.top_panel.children.length ; inx++){\n                    let top_temp = context.top_panel.children[inx].getComponent(\"SpecCards\");\n                    top_temp.reinit();\n                }\n\n                cardpanel = context.top_panel ;\n                cardprefab = context.takecards_one ;\n                deskcardpanel = context.deskcards_top_panel ;\n            }\n            /**\n             * 销毁其中一个对象\n             */\n            if(cardpanel!=null){\n                cardpanel.children[cardpanel.children.length - 1].destroy();\n            }\n            let desk_card = cc.instantiate(cardprefab);\n            let desk_script = desk_card.getComponent(\"DeskCards\");\n            desk_script.init(data.card);\n            desk_card.parent = deskcardpanel ;\n\n            context.deskcards.push(desk_card);\n        }\n    },\n    recover_desk_cards:function(userid , card , context){\n        if(userid == cc.beimi.user.id) {\n            /**\n             * 放到桌面 ， 需要重构\n             */\n            let desk_card = cc.instantiate(context.takecards_one);\n            let temp = desk_card.getComponent(\"DeskCards\");\n            temp.init(card);\n\n            context.deskcards.push(desk_card);\n            desk_card.parent = context.deskcards_current_panel;\n        }else{\n            //其他玩家出牌\n            let temp = context.player(userid , context) ;\n            let cardpanel  , cardprefab , deskcardpanel;\n            if(temp.tablepos == \"right\"){\n\n                cardpanel = context.right_panel ;\n                cardprefab = context.takecards_right ;\n                deskcardpanel = context.deskcards_right_panel ;\n\n            }else if(temp.tablepos == \"left\"){\n\n                cardpanel = context.left_panel ;\n                cardprefab = context.takecards_left ;\n                deskcardpanel = context.deskcards_left_panel ;\n            }else if(temp.tablepos == \"top\"){\n\n                cardpanel = context.top_panel ;\n                cardprefab = context.takecards_one ;\n                deskcardpanel = context.deskcards_top_panel ;\n            }\n            let desk_card = cc.instantiate(cardprefab);\n            let desk_script = desk_card.getComponent(\"DeskCards\");\n            desk_script.init(card);\n            desk_card.parent = deskcardpanel ;\n        }\n    },\n    /**\n     * 下一个玩家抓牌的事件， 如果上一个玩家出牌后，没有其他玩家杠、碰、吃、胡等动作，则会同时有一个抓牌的事件，否则，会等待玩家 杠、碰、吃、胡完成\n     * @param data\n     * @param context\n     */\n    dealcard_event:function(data , context){\n        let player = context.player(data.userid , context);\n        context.select_action_searchlight(data, context , player) ;\n\n        if(data.userid == cc.beimi.user.id){\n            context.initDealHandCards(context , data);\n        }else{\n            let inx = 0 ;\n            if(player.tablepos == \"top\"){\n                //context.right_panel ;\n                inx = 1 ;\n            }else if(player.tablepos == \"left\"){\n                inx = 2 ;\n            }\n            context.initPlayerHandCards(0 , 1 , inx , context , true);\n        }\n        context.desk_cards.string = data.deskcards ;\n        if(context.action == \"deal\" && data.userid == cc.beimi.user.id) {\n            //\n        }else{\n            context.exchange_state( \"action\", context);\n        }\n    },\n    select_action_searchlight:function(data , context , player){\n        context.exchange_searchlight(player.tablepos , context);\n        /**\n         */\n        context.exchange_state(\"nextplayer\" , context);\n    },\n    allcards_event:function(data , context){\n        cc.beimi.gamestatus = \"notready\" ;\n        //结算界面，\n        context.gameover = false ;\n        setTimeout(function(){\n            context.summarypage = cc.instantiate(context.summary) ;\n            context.summarypage.parent = context.root() ;\n            let temp = context.summarypage.getComponent(\"MaJiangSummary\") ;\n            temp.create(context , data);\n\n            if(data.gameRoomOver == true){//房间解散\n                context.gameover = true ;\n            }\n        } , 2000);\n        /**\n         */\n        context.exchange_state(\"allcards\" , context);\n    },\n    /**\n     * 恢复牌局数据， 等待服务端推送 Players数据后进行恢复\n     */\n    recoverboard:function(data,context){\n        //this.statebtn.active = false ;\n    },\n    setAction:function(action , context){\n        context.action = action ;\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    players_event:function(data,context){\n        context.collect(context) ;    //先回收资源，然后再初始化\n        var inx = 0 ;\n        for(var i=0 ; i<data.player.length ; i++){\n            let temp = data.player[i] ;\n            if(temp.id == cc.beimi.user.id){\n                context.index = i ;break ;\n            }\n        }\n        if(data.player.length > 1 && inx >=0){\n            var pos = inx+1 ;\n            while(true){\n                if(pos == data.player.length){pos = 0 ;}\n                if(context.playerexist(data.player[pos], context) == false){\n                    var player = context.playerspool.get();\n                    var playerscript = player.getComponent(\"MaJiangPlayer\");\n                    var tablepos = \"\" ;\n                    var temp = pos - context.index ;\n                    if(temp == 1 || temp == -3){\n                        //var playerscript = player.getComponent(\"MaJiangPlayer\");\n                        player.setPosition(570 , 50);\n                        tablepos = \"right\" ;\n                    }else if(temp == 2 || temp == -2){\n                        //var playerscript = player.getComponent(\"MaJiangPlayer\");\n                        player.setPosition(400 , 300);\n                        tablepos = \"top\" ;\n                    }else if(temp == 3 || temp == -1){\n                        //var playerscript = player.getComponent(\"MaJiangPlayer\");\n                        player.setPosition(-570 , 50);\n                        tablepos = \"left\" ;\n                    }\n\n                    playerscript.init(data.player[pos] , inx , tablepos);\n                    player.parent = context.root();\n                    context.playersarray.push(player) ;\n                }\n                if(pos == inx){break ;}\n                pos = pos + 1;\n            }\n        }\n    },\n    playerexist:function(player,context){\n        var inroom = false ;\n        if(player.id == cc.beimi.user.id){\n            inroom = true ;\n        }else{\n            for(var j = 0 ; j < context.playersarray.length ; j++){\n                let temp = context.playersarray[j];\n                var playerscript = temp.getComponent(\"MaJiangPlayer\");\n                if(playerscript.data.id == player.id){\n                    inroom = true ; break ;\n                }\n            }\n        }\n        return inroom ;\n    },\n    /**\n     * 接受新的庄家数据\n     * @param data\n     * @param context\n     */\n    banker_event:function(data, context){\n        /**\n         *\n         */\n        for(var inx = 0 ; inx<context.playersarray.length ; inx++){\n            let temp = context.playersarray[inx].getComponent(\"MaJiangPlayer\") ;\n            if(temp.data.id == data.userid){\n                temp.banker(); break ;\n            }\n        }\n    },\n    /**\n     * 接收到服务端的 恢复牌局的数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    recovery_event:function(data,context) {\n        var mycards = context.decode(data.player.cards);\n        //context.exchange_state(\"begin\" , context);  //隐藏 提示状态\n        /**\n         * 恢复玩家数据\n         */\n        context.play_event(data.userboard, context) ;\n\n        /**\n         * 恢复庄家数据\n         */\n        context.banker_event(data.banker,context);\n\n        /**\n         *\n         * 恢复定缺数据\n         */\n        context.selectresult_event(data.selectcolor , context);\n\n        /**\n         * 恢复其他玩家定缺数据\n         */\n        for(var i=0 ; i<data.cardsnum.length ; i++){\n            let temp = data.cardsnum[i] ;\n            context.selectresult_event(temp.selectcolor , context) ;\n            var hiscards = context.decode(temp.hiscards);\n            for(var j=0 ; j<hiscards.length ; j++){\n                context.recover_desk_cards(temp.userid , hiscards[j] , context);\n            }\n        }\n        /**\n         * 恢复当前玩家 已出的牌\n         */\n        var hiscards = context.decode(data.hiscards);\n        for(var j=0 ; j<hiscards.length ; j++){\n            context.recover_desk_cards(data.userid , hiscards[j] , context);\n        }\n    },\n    /**\n     * 接受服务端的数据，玩家杠碰、吃胡等动作\n     * @param data\n     * @param context\n     */\n    action_event:function(data, context){\n        context.setAction(\"take\" , context);\n        if(cc.beimi.user.id == data.userid){\n            /**\n             * 隐藏其他动作\n             */\n            context.exchange_state( \"action\", context);\n            /**\n             *\n             */\n            let gang , peng , chi , hu , guo;\n            if(data.deal == true){  //发牌的动作\n                for(var inx = 0 ; inx < context.actionnode_deal.children.length ; inx++){\n                    let temp = context.actionnode_deal.children[inx] ;\n                    if(temp.name == \"gang\"){gang = temp ;}\n                    if(temp.name == \"peng\"){peng = temp ;}\n                    if(temp.name == \"chi\"){chi = temp ;}\n                    if(temp.name == \"hu\"){hu = temp ;}\n                    temp.active = false ;\n                }\n                if(data.gang){gang.active = true ;}\n                if(data.peng){peng.active = true ;}\n                if(data.chi){chi.active = true ;}\n                if(data.hu){hu.active = true ;}\n\n                context.actionnode_deal.active = true ;\n\n                context.setAction(\"deal\" , context);\n            }else{\n                var actionNum = 0 ;\n                if(data.gang == true || data.peng == true || data.chi == true || data.hu == true){\n                    let desk_script = context.actionnode_three.getComponent(\"DeskCards\") ;\n                    desk_script.init(data.card);\n\n                    for(var inx = 0 ; inx < context.actionnode_three_list.children.length ; inx++){\n                        let temp = context.actionnode_three_list.children[inx] ;\n                        if(temp.name == \"gang\"){gang = temp ;}\n                        if(temp.name == \"peng\"){peng = temp ;}\n                        if(temp.name == \"chi\"){chi = temp ;}\n                        if(temp.name == \"hu\"){hu = temp ;}\n                        if(temp.name == \"guo\"){guo = temp ;}\n                        temp.active = false ;\n                    }\n                    if(data.gang){gang.active = true ; actionNum = actionNum + 1 ;}\n                    if(data.peng){peng.active = true ; actionNum = actionNum + 1 ;}\n                    if(data.chi){chi.active = true ; actionNum = actionNum + 1 ;}\n                    if(data.hu){hu.active = true ; actionNum = actionNum + 1 ;}\n                    if(data.deal == false){\n                        guo.active = true;\n                        actionNum = actionNum + 1 ;\n                    }\n                    var posx = 1080 - (actionNum + 1) * 124;\n                    var actionevent = cc.moveTo(0.5, posx, -147);\n                    actionevent.easing(cc.easeIn(3.0));\n                    context.actionnode_three.runAction(actionevent) ;\n\n                    setTimeout(function(){\n                        if(context.action != null){\n                            context.dealActionProcess(context);\n                        }\n                    } , 5000);\n                }\n            }\n        }\n    },\n    selectaction_event:function(data , context){\n        let player = context.player(data.userid , context);\n        /**\n         * 杠碰吃，胡都需要将牌从 触发玩家的 桌牌 里 移除，然后放入当前玩家 桌牌列表里，如果是胡牌，则放到 胡牌 列表里，首先\n         * 首先，需要找到触发对象，如果触发对象不是 all ， 则 直接找到 对象对应的玩家 桌牌列表，并找到 桌牌里 的最后 的 牌，\n         * 然后将此牌 移除即可，如果对象是 all， 则不用做任何处理即可\n         */\n        if(cc.beimi.user.id == data.userid){\n            /**\n             * 碰，显示碰的动画，\n             * 杠，显示杠的动画，杠分为：明杠，暗杠，弯杠，每种动画效果不同，明杠/暗杠需要扣三家分，弯杠需要扣一家分\n             * 胡，根据玩法不同，推倒胡和血流/血战\n             */\n            if(data.target == \"all\") {\n                let rightpre = cc.instantiate(context.action_gang_ming_prefab);\n                rightpre.parent = context.deskcards_right_panel.parent;\n\n                let toppre = cc.instantiate(context.action_gang_ming_prefab);\n                toppre.parent = context.deskcards_top_panel.parent;\n\n                let leftpre = cc.instantiate(context.action_gang_ming_prefab);\n                leftpre.parent = context.deskcards_left_panel.parent;\n            }else{\n                //碰的特效\n                context.select_action_searchlight(data, context , player) ;\n            }\n\n\n\n            if(data.action == \"hu\") {\n                //胡牌了，把胡的牌放入到胡牌列表里，然后 ， 把当前的玩家的牌局置为不可点击\n                let hu_card = cc.instantiate(context.takecards_one);\n                let temp = hu_card.getComponent(\"DeskCards\");\n                temp.init(data.card);\n\n                context.deskcards.push(hu_card);\n                hu_card.setScale (0.5 , 0.5) ;\n                hu_card.parent = context.hu_cards_current;\n                context.mask.active = true ;    //遮罩，不让操作了\n\n            }else{\n                /**\n                 * 杠后移除当前手牌，进入到 杠 列表里\n                 */\n                for(var inx = 0 ; inx < context.playercards.length ; ){\n                    let temp = context.playercards[inx].getComponent(\"HandCards\");\n                    if(data.cardtype == temp.mjtype && data.cardvalue == temp.mjvalue){\n                        context.cardpool.put(context.playercards[inx]) ;\n                        context.playercards.splice(inx, 1) ;\n                    }else{\n                        inx++ ;\n                    }\n                }\n\n                let cards_gang;\n\n                /**\n                 * 刚和碰共用一个 Prefab，都是来自于 cards_gang_ming_prefab ，显示方式也相同， 区别在于：刚显示四张牌，碰显示两张牌\n                 */\n                if (data.actype == \"an\") {\n                    cards_gang = cc.instantiate(context.cards_gang_an_prefab);\n                } else {\n                    cards_gang = cc.instantiate(context.cards_gang_ming_prefab);\n                }\n                let temp_script = cards_gang.getComponent(\"GangAction\");\n                if (data.action == \"gang\") {\n                    temp_script.init(data.card, true);\n                } else {\n                    temp_script.init(data.card, false);\n                }\n                if (data.action == \"peng\" || data.action == \"chi\") {\n                    /**\n                     *\n                     * 碰了以后的\n                     */\n                    let temp = context.cards_panel.children[context.cards_panel.children.length - 1];\n                    if (temp != null) {\n                        let script = temp.getComponent(\"HandCards\");\n                        if (script != null) {\n                            script.lastone();\n                        }\n                    }\n                }\n\n                cards_gang.parent = context.gang_current;\n                context.actioncards.push(cards_gang);\n\n                for (var inx = 0; inx < context.deskcards.length; inx++) {\n                    var temp = context.deskcards[inx];\n                    if (temp != null) {\n                        var script = temp.getComponent(\"DeskCards\");\n                        if (script != null && script.value == data.card) {\n                            temp.destroy();\n                            context.deskcards.splice(inx, inx + 1);\n                            break;\n                        }\n                    }\n                }\n            }\n\n            context.exchange_state(\"nextplayer\" , context);\n\n            /**\n             * 隐藏 动作 按钮\n             */\n            context.exchange_state( \"action\", context);\n        }else{\n            //以下代码是用于找到 杠/碰/吃/胡牌的 目标牌  ， 然后将此牌 从 桌面牌中移除\n            let temp = context.player(data.target, context), deskcardpanel;\n            if (temp.tablepos == \"right\") {\n                deskcardpanel = context.deskcards_right_panel;\n            } else if (temp.tablepos == \"left\") {\n                deskcardpanel = context.deskcards_left_panel;\n            } else if (temp.tablepos == \"top\") {\n                deskcardpanel = context.deskcards_top_panel;\n            }\n            if (deskcardpanel.children.length > 0) {\n                deskcardpanel.children[deskcardpanel.children.length - 1].destroy();\n            }\n        }\n    },\n    /**\n     * 接收发牌信息，需要根据玩家位置确定是哪家的牌\n     * @param data\n     * @param context\n     */\n    play_event:function(data , context ){\n        cc.beimi.gamestatus = \"playing\" ;\n        /**\n         * 改变状态，开始发牌\n         */\n        context.exchange_state(\"begin\" , context);\n\n\n        var temp_player = data.player ;\n        var cards = context.decode(temp_player.cards);\n\n        setTimeout(function(){\n            context.calcdesc_cards(context , 136 , data.deskcards) ;\n        } , 0) ;\n        var groupNums = 0 ;\n        for(var times = 0 ; times < 4 ; times++){\n            context.initMjCards(groupNums , context , cards , temp_player.banker) ;\n            /**\n             * 初始化其他玩家数据\n             */\n            var inx = 0 ;\n            for(var i=0 ; i<data.players.length ; i++){\n                if(data.players[i].playuser != cc.beimi.user.id){\n                    context.initPlayerHandCards(groupNums , data.players[inx++].deskcards , inx,context , false);\n                }\n            }\n            groupNums = groupNums + 1 ;\n        }\n\n        let ani = context.cards_panel.getComponent(cc.Animation);\n        ani.play(\"majiang_reorder\") ;\n\n\n        var maxvalue  = -100;\n        var maxvalluecard ;\n        for(var i=0 ; i<context.playercards.length ; i++ ){\n            let temp_script = context.playercards[i].getComponent(\"HandCards\") ;\n            if(temp_script.value >= 0){\n                context.playercards[i].zIndex = temp_script.value ;\n            }else{\n                context.playercards[i].zIndex = 200 + temp_script.value ;\n            }\n            if(context.playercards[i].zIndex > maxvalue){\n                maxvalue = context.playercards[i].zIndex ;\n                maxvalluecard = context.playercards[i] ;\n            }\n        }\n        /**\n         * 重新排序\n         */\n        context.layout(context.cards_panel,function(fir ,sec){\n            return fir.zIndex - sec.zIndex ;\n        });\n\n\n        setTimeout(function(){\n            if(temp_player.banker == true && maxvalluecard!=null){\n                maxvalluecard.getComponent(\"HandCards\").lastone() ;\n            }\n        } , 200) ;\n\n\n        context.exchange_state(\"play\" , context);\n\n        /**\n         * 统一处理排序 的动画\n         */\n\n        /**\n         * 初始化状态，首个玩家加入，然后开始等待其他玩家 ， 如果是 恢复数据， 则不会进入\n         */\n        //this.statusbtn.active = true ;\n    },\n    /**\n     * 开始定缺\n     * @param data\n     * @param context\n     */\n    selectcolor_event:function(data, context){\n        /**\n         *\n         */\n        for(var inx = 0 ; inx<context.playersarray.length ; inx++){\n            let temp = context.playersarray[inx].getComponent(\"MaJiangPlayer\") ;\n            if(temp.data.id == cc.beimi.user.id){\n                temp.selecting();\n            }\n        }\n\n        context.exchange_state(\"selectcolor\" , context);\n    },\n    /**\n     * 通知定缺结果\n     * @param data\n     * @param context\n     */\n    selectresult_event:function(data, context){\n        /**\n         *\n         */\n        for(var inx = 0 ; inx<context.playersarray.length ; inx++){\n            let temp = context.playersarray[inx].getComponent(\"MaJiangPlayer\") ;\n            if(temp.data.id == data.userid){\n                temp.selectresult(data);\n                break ;\n            }\n        }\n        if(data.userid == cc.beimi.user.id){\n            context.exchange_state(\"selectresult\" , context);\n            if(data.color < 10){\n                context.changecolor(data , context);\n            }\n        }\n    },\n    /**\n     * 开始打牌，状态标记\n     * @param data\n     * @param context\n     */\n    lasthands_event:function(data, context){\n        if(data.userid == cc.beimi.user.id){    //该我出牌 , 庄家出牌，可以不用判断是否庄家了 ，不过，庄家数据已经传过来了\n            context.exchange_state(\"lasthands\" , context);\n            context.exchange_searchlight(\"current\",context);\n        }else{\n            context.exchange_state(\"otherplayer\" , context);    //当前玩家出牌，计时器开始计时，探照灯照向该玩家\n            for(var inx = 0 ; inx<context.playersarray.length ; inx++){\n                let temp = context.playersarray[inx].getComponent(\"MaJiangPlayer\") ;\n                if(temp.data.id == data.userid){\n                    context.exchange_searchlight(temp.tablepos,context);; break ;\n                }\n            }\n        }\n    },\n    changecolor:function(data , context){\n        let lastcard ;\n        for(var inx = 0 ; inx < context.playercards.length ; inx++){\n            let temp = context.playercards[inx].getComponent(\"HandCards\");\n            temp.relastone();\n            if(parseInt(temp.value / 36) == data.color && temp.value >= 0){\n                temp.selected();\n                context.playercards[inx].zIndex = 1000 + temp.value ;\n                if(lastcard == null || lastcard.zIndex < context.playercards[inx].zIndex){\n                    lastcard = context.playercards[inx] ;\n                }\n            }\n        }\n        /**\n         * 重新排序\n         */\n        context.layout(context.cards_panel,function(fir ,sec){\n            return fir.zIndex - sec.zIndex ;\n        });\n        if(data.banker == cc.beimi.user.id && lastcard != null){\n            let temp = lastcard.getComponent(\"HandCards\");\n            temp.lastone();\n        }\n    },\n    /**\n     * 显示 剩余牌\n     * @param start\n     * @param end\n     */\n    calcdesc_cards:function(context ,start , end){\n        start = start - 1 ;\n        if(start > end){\n            context.desk_cards.string = start ;\n            setTimeout(function(){\n                context.calcdesc_cards(context , start , end ) ;\n            } , 15) ;\n        }\n    },\n    initDealHandCards:function(context , data){\n        let temp = context.cardpool.get();\n        let temp_script = temp.getComponent(\"HandCards\") ;\n\n        context.playercards.push(temp);\n\n        temp_script.init(data.card);\n\n        temp_script.lastone();\n        if(parseInt(data.card / 36) == data.color && data.card >= 0){\n            temp_script.selected() ;\n        }\n        temp.zIndex = 2000; //直接放到最后了，出牌后，恢复 zIndex\n        temp.parent = context.cards_panel ;  //庄家的最后一张牌\n    },\n    /**\n     * 初始化其他玩家手牌，\n     * @param groupNums\n     * @param deskcards\n     * @param inx\n     * @param context\n     * @param spec 是否特殊的牌，即刚抓起来的牌\n     */\n    initPlayerHandCards:function(groupNums , deskcards , inx , context , spec){\n        let parent = context.right_panel  ;\n        let cardarray = context.rightcards;\n        let prefab = context.cards_right ;\n\n        if(inx == 1){\n            parent = context.top_panel  ;\n            cardarray = context.topcards   ;\n            prefab = context.cards_top ;\n        }else if(inx == 2){\n            parent = context.left_panel  ;\n            cardarray = context.leftcards;\n            prefab = context.cards_left ;\n        }\n        context.initOtherCards(groupNums , context , deskcards , prefab , cardarray , parent , spec , inx);    //左侧，\n    },\n    initOtherCards:function(group , context , cards , prefab , cardsarray, parent , spec , inx){\n        for(var i=group*4 ; i< cards && i<(group+1)*4 ; i++) {\n            //let temp = context.cardpool.get();\n            //temp.parent = parent ;\n            let temp = cc.instantiate(prefab) ;\n            let temp_script = temp.getComponent(\"SpecCards\") ;\n            temp_script.init(spec,inx);\n\n            temp.parent = parent ;\n            cardsarray.push(temp) ;\n        }\n    },\n    initMjCards:function(group , context , cards , banker){\n        for(var i=group*4 ; i< cards.length && i<(group+1)*4 ; i++){\n            let temp = context.cardpool.get();\n            let temp_script = temp.getComponent(\"HandCards\") ;\n\n            context.playercards.push(temp);\n\n            temp_script.init(cards[i]);\n\n            if(banker == true && i == (cards.length - 1)){\n                temp.parent = context.one_card_panel ;  //庄家的最后一张牌\n            }else{\n                temp.parent = context.cards_panel ;\n            }\n\n            setTimeout(function(){\n                temp.parent = context.cards_panel ;\n            } , 200) ;\n        }\n    },\n    /**\n     * 回收系统资源，用于清理资源\n     * @param context\n     */\n    collect:function(context){\n        for(var i=0 ; i<context.playersarray.length ; ){\n            let player = context.playersarray[i] ;\n            var playerscript = player.getComponent(\"MaJiangPlayer\");\n            if(playerscript.data.id != cc.beimi.user.id){       //当前 玩家不回收，最终 Destroy 的时候会被回收\n                context.playerspool.put(player);\n                context.playersarray.splice(i,1) ;\n            }else{\n                i++ ;\n            }\n        }\n    },\n    /**\n     * 按钮操作，点击 开始游戏按钮后的触发动作，进入计时，然后等待服务端推送数据和 状态机流程流转\n     */\n    waittingForPlayers:function(){\n        this.exchange_state(\"ready\" , this);\n    },\n    player:function(pid , context){\n        let player ;\n        for(var inx = 0 ; inx<context.playersarray.length ; inx++){\n            let temp = context.playersarray[inx].getComponent(\"MaJiangPlayer\") ;\n            if(temp.data.id == pid){\n                player = temp ; break ;\n            }\n        }\n        return player ;\n    },\n    /**\n     * 状态切换，使用状态参数 切换，避免直接修改 对象状态，避免混乱\n     */\n    exchange_state:function(state , object){\n        let readybtn = null , waitting = null , selectbtn = null , banker = null ;\n        for(var i=0 ; i<object.statebtn.children.length ; i++){\n            let target = object.statebtn.children[i] ;\n            if(target.name == \"readybtn\"){\n                readybtn = target ;\n            }else if(target.name == \"waitting\"){\n                waitting = target ;\n            }else if(target.name == \"select\"){\n                selectbtn = target ;\n            }else if(target.name == \"banker\"){\n                banker = target ;\n            }\n            target.active = false ;\n        };\n        switch(state){\n            case \"init\" :\n                object.desk_tip.active = false;\n                readybtn.active = true ;\n                object.actionnode_deal.active =false ;\n\n                /**\n                 * 探照灯 熄灭\n                 */\n                object.exchange_searchlight(\"none\",object);\n\n                break;\n            case \"ready\" :\n                waitting.active = true ;\n                if(cc.beimi.data!=null && cc.beimi.data.enableai == true) {\n                    object.timer(object, cc.beimi.data.waittime);\n                }else{\n                    object.timer(object, cc.beimi.data.noaiwaitime);\n                }\n                break;\n            case \"begin\" :\n                waitting.active = false ;\n                /**\n                 * 显示 当前还有多少张底牌\n                 * @type {boolean}\n                 */\n                object.desk_tip.active = true;\n                /**\n                 * 开始发牌动画，取消所有进行中的计时器\n                 */\n                object.canceltimer(object);\n                break;\n            case \"play\" :\n                /**\n                 * 一个短暂的状态，等待下一步指令是 定缺 还是直接开始打牌 ， 持续时间的计时器是 2秒\n                 */\n                object.timer(object , 2) ;\n                break   ;\n            case \"selectcolor\" :\n                /**\n                 * 定缺 ，由服务端确定是否有此个节点，下个版本将会实现流程引擎控制 游戏 节点，一切都在服务端 进行配置工作\n                 * @type {boolean}\n                 */\n                object.exchange_searchlight(\"current\",object);\n                selectbtn.active = true ;\n                object.timer(object , 5) ;\n                break   ;\n            case \"selectresult\" :\n                /**\n                 * 选择了定缺结果，关闭选择按钮\n                 * @type {boolean}\n                 */\n                selectbtn.active = false ;\n                object.canceltimer(object) ;\n                break   ;\n            case \"lasthands\" :\n                /**\n                 * 选择了定缺结果，关闭选择按钮\n                 * @type {boolean}\n                 */\n                banker.active = true ;\n                /**\n                 * 计时器方向\n                 */\n                object.timer(object , 8) ;\n                break   ;\n            case \"otherplayer\" :\n                /**\n                 * 计时器方向\n                 */\n                object.timer(object , 8) ;\n                break   ;\n            case \"takecard\" :\n                /**\n                 * 选择了定缺结果，关闭选择按钮\n                 * @type {boolean}\n                 */\n                banker.active = false;\n                //object.canceltimer(object) ;\n                break   ;\n            case \"action\" :\n                /**\n                 * 隐藏 杠碰吃胡 等 操作\n                 */\n                object.dealActionProcess(object);\n                break;\n            case \"nextplayer\" :\n                /**\n                 * 选择了定缺结果，关闭选择按钮\n                 * @type {boolean}\n                 */\n                object.timer(object , 8) ;\n                break   ;\n            case \"allcards\" :\n                /**\n                 * 都打完了，结束了，回收计时器，回收定缺，回收庄家\n                 * @type {boolean}\n                 */\n                for(var i=0 ; i<object.playersarray.length ; i++){\n                    let player = object.playersarray[i] ;\n                    var playerscript = player.getComponent(\"MaJiangPlayer\");\n                    playerscript.clean();\n                }\n                object.canceltimer(object) ;\n                break   ;\n        }\n    },\n    exchange_searchlight:function(direction , context){\n        for(var inx = 0 ; inx<context.searchlight.children.length ; inx++){\n            if(direction == context.searchlight.children[inx].name){\n                context.searchlight.children[inx].active = true ;\n            }else{\n                context.searchlight.children[inx].active = false ;\n            }\n        }\n    },\n    dealActionProcess:function(object){\n        var actionevent = cc.moveTo(0.5, 1080, -147);\n        actionevent.easing(cc.easeIn(3.0));\n\n        object.actionnode_three.runAction(actionevent) ;\n\n        if(object.action == \"deal\") {\n            object.actionnode_deal.active = false ;\n        }\n        object.action = null ;\n    },\n    canceltimer:function(object){\n        object.unscheduleAllCallbacks();\n        object.mjtimer.string = \"00\" ;\n    },\n    recovery:function(){\n        //this.initgame();\n    },\n    timer:function(object , times){\n        if(times > 9){\n            object.mjtimer.string = times ;\n        }else{\n            object.mjtimer.string = \"0\"+times ;\n        }\n\n        object.callback = function(){\n            times = times - 1 ;\n            if(times >= 0){\n                let text = times ;\n                if(times < 10){\n                    text = \"0\"+times ;\n                }\n                object.mjtimer.string = text ;\n            }\n        }\n        object.unscheduleAllCallbacks();\n        /**\n         * 启动计时器，应该从后台传入 配置数据，控制 等待玩家 的等待时长\n         */\n        object.schedule(object.callback, 1, times, 0);\n    },\n    clean:function(){\n        /**\n         * 销毁玩家数据\n         */\n        for(var i =0 ; i<this.playercards.length ; i++){\n            this.playercards[i].destroy();\n        }\n        this.playercards.splice( 0 , this.playercards.length) ;\n        /**\n         * 销毁桌面上已打出的牌\n         */\n        for(var i =0 ; i<this.deskcards.length ; i++){\n            this.deskcards[i].destroy();\n        }\n        this.deskcards.splice( 0 , this.deskcards.length) ;\n        /**\n         * 销毁左侧玩家的手牌\n         */\n        for(var i =0 ; i<this.leftcards.length ; i++){\n            this.leftcards[i].destroy();\n        }\n        this.leftcards.splice( 0 , this.leftcards.length) ;\n        /**\n         * 销毁右侧玩家的手牌\n         */\n        for(var i =0 ; i<this.rightcards.length ; i++){\n            this.rightcards[i].destroy();\n        }\n        this.rightcards.splice( 0 , this.rightcards.length) ;\n        /**\n         * 销毁对家的手牌\n         */\n        for(var i =0 ; i<this.topcards.length ; i++){\n            this.topcards[i].destroy();\n        }\n        this.topcards.splice( 0 , this.topcards.length) ;\n\n        for(var i=0 ; i<this.actioncards.length ; i++){\n            this.actioncards[i].destroy() ;\n        }\n        this.actioncards.splice(0,this.actioncards.length) ;\n        /**\n         * 玩家数据销毁条件（房间解散，或者有玩家退出房价的时候，所有玩家数据销毁后冲洗排序）\n         */\n        this.mask.active = false ;\n    },\n    restart:function(){\n        /**\n         * 清理桌面\n         */\n        this.clean();\n        /**\n         * 初始化桌面\n         */\n        if(this.gameover == true){\n            for(var inx = 0 ; inx<this.player.length ; inx++){\n                this.player[inx].destroy();\n            }\n            this.player.splice(0 , this.player.length) ;//房间解散，释放资源\n            this.player = new Array();\n\n            this.initdata(true);\n        }else{\n            this.initdata(false);\n        }\n\n        /**\n         * 系统资源回收完毕，发送一个 重新开启游戏的 通知\n         */\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"restart\",\"restart\");\n        }\n    },\n    /**\n     * 开始游戏\n     */\n    startgame:function(){\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"start\",\"true\");\n        }\n    },\n    onDestroy:function(){\n        // if(this.ready()) {\n        //     let socket = this.socket();\n        //     socket.disconnect();\n        // }\n        this.inited = false ;\n        this.cleanmap();\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"leave\",\"leave\");\n        }\n    },\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}