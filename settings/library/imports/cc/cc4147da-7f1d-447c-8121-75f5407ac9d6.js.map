{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\module\\game\\dizhu\\script/assets\\module\\game\\dizhu\\script\\DizhuBegin.js"],"names":["beiMiCommon","require","cc","Class","extends","properties","gamebtn","default","type","Node","continuegamebtn","poker","lastCardsPanel","waitting","Prefab","ratio","Label","summary_win","summary","inviteplayer","onLoad","resize","player","Array","pokercards","lastcards","active","summarypage","inited","lasttip","beimi","gamestatus","recovery","extparams","gamemodel","invite","instantiate","initgame","begin","data","enableai","statictimer","waittime","noaiwaitime","startgame","opendeal","self","ready","socket","game","getCommon","map","joinroom_event","players_event","catch_event","catchresult_event","lasthands_event","takecards_event","ratio_event","play_event","allcards_event","cardtips_event","roomready_event","playeready_event","recovery_event","on","result","parse","route","command","param","token","authorization","playway","orgi","user","exec","context","cardroom","script","getComponent","init","roomid","parent","root","id","index","inroom","i","length","userid","newplayer","destroy","inx","pos","playerexist","maxplayers","j","string","catchtimer","render","mycards","decode","cards","waittimer","timer","stop","doLastCards","pokencard","playcards","registerProxy","order","lasthands","last","setCard","banker","getPlayer","setDizhuFlag","lasttakecards","cardsnum","nextplayer","playtimer","automic","resetcards","king","bomb","catchresult","setTimeout","hideresult","func","callFunc","target","tempcontext","layout","fir","sec","zIndex","pc","current","beiMiCard","card","allow","donot","unselected","selectedcards","splice","over","notallow","tipcards","join","cardtips","cardtipsfornot","center","pokerpool","get","left","right","setPosition","finished","put","dealing","reordering","players","temp","tempscript","pva","balance","updatepva","win","create","gameRoomOver","clean","tempRender","num","times","myCards","otherplayer","currpoker","seq","sequence","spawn","moveTo","scaleTo","runAction","countcards","width","minpokerpool","myCard","proxy","posx","setScale","push","action","isRight","v2","playerspool","size","initplayer","givup","emit","docatch","doPlayCards","selected","noCards","onCloseClick","restart","continuegame","message","time","onDestroy","cleanmap"],"mappings":"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","file":"DizhuBegin.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\module\\game\\dizhu\\script","sourcesContent":["var beiMiCommon = require(\"BeiMiCommon\");\ncc.Class({\n    extends: beiMiCommon,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        gamebtn: {\n            default: null,\n            type: cc.Node\n        },\n        continuegamebtn:{\n            default: null,\n            type: cc.Node\n        },\n        poker: {\n            default: null,\n            type: cc.Node\n        },\n        lastCardsPanel: {   //底牌\n            default: null,\n            type: cc.Node\n        },\n        waitting: {\n            default: null,\n            type: cc.Prefab\n        },\n        ratio:{   //底牌\n            default: null,\n            type: cc.Label\n        },\n        summary_win:{\n            default:null ,\n            type : cc.Prefab\n        },\n        summary:{\n            default:null ,\n            type : cc.Prefab\n        },\n        inviteplayer:{\n            default:null ,\n            type : cc.Prefab\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        /**\n         * 适配屏幕尺寸\n         */\n        this.resize();\n\n        this.player = new Array() ;     //存放玩家数据\n        this.pokercards = new Array();\n        this.lastcards = new Array();\n        this.lastCardsPanel.active = false ;\n        this.summarypage = null ;\n        this.inited = false ;\n        this.lasttip = null ;\n        if(cc.beimi!=null){\n            if(cc.beimi.gamestatus!=null && cc.beimi.gamestatus == \"playing\"){\n                //恢复数据\n                this.recovery() ;\n            }else if(cc.beimi.extparams!=null && cc.beimi.extparams.gamemodel == \"room\"){\n                /**\n                 * 房卡模式，开始启动游戏，当前玩家进入等待游戏的状态，显示邀请好友游戏，并分配 6位数字的房间号码\n                 */\n                /**\n                 * 处理完毕，清理掉全局变量\n                 * @type {null}\n                 */\n                this.invite = cc.instantiate(this.inviteplayer) ;\n            }\n            this.initgame();\n        }\n    },\n    begin:function(){\n        if(cc.beimi.data!=null && cc.beimi.data.enableai == true){\n            this.statictimer(\"正在匹配玩家\" , cc.beimi.data.waittime) ;\n        }else{\n            this.statictimer(\"正在匹配玩家，请稍候\" , cc.beimi.data.noaiwaitime) ;\n        }\n        this.startgame(\"false\") ;\n    },\n    opendeal:function(){\n        if(cc.beimi.data!=null && cc.beimi.data.enableai == true){\n            this.statictimer(\"正在匹配玩家\" , cc.beimi.data.waittime) ;\n        }else{\n            this.statictimer(\"正在匹配玩家，请稍候\" , cc.beimi.data.noaiwaitime) ;\n        }\n        this.startgame(\"true\") ;\n    },\n    recovery:function(){\n        this.statictimer(\"正在恢复数据，请稍候\" , cc.beimi.data.waittime) ;\n    },\n    initgame:function(){\n        let self = this ;\n        this.gamebtn.active = true ;\n        this.continuegamebtn.active = false ;\n        if(this.ready()) {\n            let socket = this.socket();\n\n\n\n            this.game = this.getCommon(\"DizhuDataBind\");\n\n            this.map(\"joinroom\" , this.joinroom_event) ;          //加入房价\n            this.map(\"players\" , this.players_event) ;            //接受玩家列表\n            this.map(\"catch\" , this.catch_event) ;                  //叫地主\n            this.map(\"catchresult\" , this.catchresult_event) ;      //最终抢到地主的玩家\n            this.map(\"lasthands\" , this.lasthands_event) ;            //翻底牌\n            this.map(\"takecards\" , this.takecards_event) ;            //出牌信息\n            this.map(\"ratio\" , this.ratio_event) ;                      //有炸\n            this.map(\"play\" , this.play_event) ;                      //接受玩家列表\n            this.map(\"allcards\" , this.allcards_event) ;              //我出的牌\n            this.map(\"cardtips\" , this.cardtips_event) ;              //提示\n            this.map(\"roomready\" , this.roomready_event) ;              //提示\n\n            this.map(\"playeready\" , this.playeready_event) ;            //玩家点击了开始游戏 ， 即准备就绪\n\n            this.map(\"cardtips\" , this.cardtips_event) ;              //提示\n\n            this.map(\"recovery\" , this.recovery_event) ;              //恢复牌局数据\n\n            socket.on(\"command\" , function(result){\n                cc.beimi.gamestatus = \"playing\" ;\n                if(self.inited == true){\n                    var data = self.parse(result) ;\n                    self.route(data.command)(data , self);\n                }\n            });\n            /**\n             * 心跳检查，服务端发起的事件，服务端可以设置 PING的时长和 PING的 TimeOut\n             */\n            socket.on(\"ping\" , function(){\n\n            });\n\n            /**\n             *   此处有个问题：游戏中，如果点击了返回，进入过其他游戏，这个 cc.beimi.extparams.playway\n             *   就发生了改变，会导致当前游戏结束后，继续游戏的时候会出现问题\n             * @type {{token: (*|null), playway, orgi, extparams: *}}\n             */\n            var param = {\n                token:cc.beimi.authorization,\n                playway:cc.beimi.extparams.playway,\n                orgi:cc.beimi.user.orgi,\n                extparams:cc.beimi.extparams\n            } ;\n            socket.exec(\"joinroom\" ,param) ;\n\n            this.inited = true ;\n        }\n\n    },\n    /**\n     * 新创建牌局，首个玩家加入，进入等待状态，等待其他玩家加入，服务端会推送 players数据\n     * @param data\n     * @param context\n     */\n    joinroom_event:function(data , context){\n\n        if(data.cardroom == true && context.inviteplayer!=null){\n            let script = context.invite.getComponent(\"BeiMiQR\")\n            script.init(data.roomid);\n            context.invite.parent = context.root() ;\n        }\n\n\n        //显示 匹配中，并计时间，超过设定的倒计时时间即AI加入，根据当前的 玩家数量 匹配机器人\n        if(data.player.id && data.player.id == cc.beimi.user.id){\n            //本人，开始计时\n            //console.log(\"本人\") ;\n            //self.player[0] = data ;\n            context.index = data.index ;   //当前玩家所在位置\n        }else{\n            //其他玩家加入，初始化\n            var inroom = false ;\n            for(var i = 0 ; i < context.player.length ; i++){\n                var player = context.player[i].getComponent(\"PlayerRender\") ;\n                if(player.userid == data.player.id){\n                    inroom = true ;\n                }\n            }\n            if(inroom == false){\n                context.newplayer(context.player.length , context , data.player , context.index + 1 == data.index) ;\n            }\n        }\n    },\n    /**\n     * 房卡模式下，邀请的好友人到齐了\n     * @param data\n     * @param context\n     */\n    roomready_event:function(data , context){\n        if(data.cardroom == true && context.invite!=null){\n            context.invite.destroy();\n        }\n    },\n    /**\n     *\n     * @param data\n     * @param context\n     */\n    playeready_event:function(data , context){\n        if(data.userid == cc.beimi.user.id){\n            context.gamebtn.active = false ;\n        }\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局 , 玩家座位排列方式 ， 和麻将统一， 都是东南西北方式 排列\n     * 0是首位玩家\n     * 1是右侧玩家\n     * 2是左侧玩家\n     * 麻将还有一个对家\n     * @param data\n     * @param context\n     */\n    players_event:function(data,context){\n        var inx = -1 ;\n        for(var i = 0 ; i<data.player.length ; i++){\n            if(data.player[i].id == cc.beimi.user.id){\n                inx = i ; break ;\n            }\n        }\n        if(data.player.length > 1 && inx >=0){\n            var pos = inx+1 ;\n            while(true){\n                if(pos == data.player.length){pos = 0 ;}\n                if(context.playerexist(data.player[pos], context) == false){\n                    context.newplayer(context.player.length , context , data.player[pos] , context.player.length == 0 && !(pos == 0 && data.player.length < data.maxplayers) ) ;\n                }\n                if(pos == inx){break ;}\n                pos = pos + 1;\n            }\n        }\n    },\n    playerexist:function(player,context){\n        var inroom = false ;\n        if(player.id == cc.beimi.user.id){\n            inroom = true ;\n        }else{\n            for(var j = 0 ; j < context.player.length ; j++){\n                if(context.player[j].id == player.id){\n                    inroom = true ; break ;\n                }\n            }\n        }\n        return inroom ;\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    catch_event:function(data,context){\n        /**\n         * 修改倍率\n         */\n        if(context.ratio){\n            context.ratio.string = data.ratio+\"倍\" ;\n        }\n        if(data.userid == cc.beimi.user.id){    //该我抢\n            context.game.catchtimer(15);\n        }else{                              //该别人抢\n            for(var inx =0 ; inx<context.player.length ; inx++){\n                var render = context.player[inx].getComponent(\"PlayerRender\") ;\n                if(render.userid && render.userid == data.userid){\n                    render.catchtimer(15);\n                    break ;\n                }\n            }\n        }\n    },\n    /**\n     * 接收到服务端的 恢复牌局的数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    recovery_event:function(data,context){\n        var mycards = context.decode(data.player.cards);\n        if(context.waittimer != null){\n            let timer = context.waittimer.getComponent(\"BeiMiTimer\");\n            if(timer){\n                timer.stop(context.waittimer) ;\n            }\n        }\n\n        /**\n         * 清理掉 extparam;\n         * @type {boolean}\n         */\n\n        context.gamebtn.active = false ;\n\n        if(context.ratio){\n            context.ratio.string = data.ratio+\"倍\" ;\n        }\n\n        context.doLastCards(context.game , context , 3 , 0);\n        for(var inx =0 ; inx  < mycards.length ; inx++){\n            let pokencard = context.playcards(context.game , context, inx * 50-300 , mycards[inx]);\n            context.registerProxy(pokencard);\n        }\n        /**\n         * 赋值，解码牌面\n         */\n        for(var i=0 ; i<context.pokercards.length ; i++){\n            var pokencard = context.pokercards[i];\n            pokencard.getComponent(\"BeiMiCard\").order();\n        }\n        context.lastCardsPanel.active = true ;\n\n        if(data.lasthands){\n            var lasthands = context.decode(data.lasthands);\n            /**\n             * 底牌 ， 顶部的 三张底牌显示区域\n             */\n            for(var i=0 ; i<context.lastcards.length ; i++){\n                var last = context.lastcards[i].getComponent(\"BeiMiCard\") ;\n                last.setCard(lasthands[i]);\n                last.order();\n            }\n            /**\n             * 设置地主标志\n             */\n            if(data.banker.userid == cc.beimi.user.id){\n                context.game.lasthands(context , context.game , data.data ) ;\n            }else{\n                context.getPlayer(data.banker.userid).setDizhuFlag(data.data);\n            }\n        }\n        /**\n         * 恢复最后出的牌\n         */\n        if(data.last != null){\n            let lastcards = context.decode(data.last.cards);        //解析牌型\n            if (data.last.userid == cc.beimi.user.id) {\n                context.game.lasttakecards(context.game, context, data.last.cardsnum, lastcards , data.last);\n            } else {\n                context.getPlayer(data.last.userid).lasttakecards(context.game, context, data.last.cardsnum, lastcards , data.last);\n            }\n\n            if (data.nextplayer  == cc.beimi.user.id) {\n                context.game.playtimer(context.game, 25 , data.automic);\n            } else {\n                context.getPlayer(data.nextplayer).playtimer(context.game, 25);\n            }\n        }\n        if(data.cardsnum!=null && data.cardsnum.length > 0){\n            for(var i =0 ; i<data.cardsnum.length ; i++){\n                context.getPlayer(data.cardsnum[i].userid).resetcards(data.cardsnum[i].cardsnum);\n            }\n        }\n    },\n    /**\n     * 有玩家出炸\n     * @param data\n     * @param context\n     */\n    ratio_event:function(data,context){\n        /**\n         * 修改倍率\n         */\n\n        if(data.king == true){\n            //王炸，播放音效\n        }else if(data.bomb == true){\n            //普通炸弹，播放音效\n        }\n        if(context.ratio){\n            context.ratio.string = data.ratio+\"倍\" ;\n        }\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    catchresult_event:function(data,context){\n        /**\n         * 修改倍率\n         */\n        if(context.ratio){\n            context.ratio.string = data.ratio+\"倍\" ;\n        }\n        if(data.userid == cc.beimi.user.id){    //该我抢\n            context.game.catchresult(data);\n        }else{                              //该别人抢\n            setTimeout(function(){\n                context.getPlayer(data.userid).catchresult(data);\n            },1500) ;\n        }\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    lasthands_event:function(data,context){\n        var lasthands = context.decode(data.lasthands);\n        /**\n         * 底牌 ， 顶部的 三张底牌显示区域\n         */\n        for(var i=0 ; i<context.lastcards.length ; i++){\n            var last = context.lastcards[i].getComponent(\"BeiMiCard\") ;\n            last.setCard(lasthands[i]);\n            last.order();\n        }\n        /**\n         * 当前玩家的 底牌处理\n         */\n        if(data.userid == cc.beimi.user.id) {\n            context.game.lasthands(context , context.game , data ) ;\n            /**\n             * 隐藏 其他玩家的 抢地主/不抢地主的 提示信息\n             */\n            for(var inx =0 ; inx<context.player.length ; inx++){\n                var render = context.player[inx].getComponent(\"PlayerRender\") ;\n                render.hideresult();\n            }\n\n            for(var i=0 ; i<lasthands.length ; i++){\n                let func = null ;\n                if(i == (lasthands.length - 1)){\n                    func = cc.callFunc(function (target , data) {\n                        if(data.tempcontext){\n                            data.tempcontext.layout(data.tempcontext.poker , function(fir , sec){\n                                return fir.zIndex - sec.zIndex ;\n                            });\n                        }\n                    }, this , {tempcontext: context});\n                }\n                let pc = context.current(context.game , context ,2 * 300 + (6 + i) * 50-300, lasthands[i] , func) ;\n                var beiMiCard = pc.getComponent(\"BeiMiCard\") ;\n                beiMiCard.order();\n                context.registerProxy(pc);\n            }\n\n            context.game.playtimer(context.game,25 , true);\n        }else{\n            context.game.hideresult();\n            for(var inx =0 ; inx<context.player.length ; inx++){\n                var render = context.player[inx].getComponent(\"PlayerRender\") ;\n                render.hideresult();\n            }\n            context.getPlayer(data.userid).lasthands(context,context.game,data);\n            context.getPlayer(data.userid).playtimer(context.game , 25);\n        }\n        for(var inx =0 ; inx<context.pokercards.length ; inx++){\n            var pc = context.pokercards[inx] ;\n            pc.zIndex = 54 - pc.card ;\n        }\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    takecards_event:function(data,context){\n        context.lasttip = null ;\n        if(data.allow == true) {\n            var lastcards ;\n            if(data.donot == false){\n                lastcards = context.decode(data.cards);        //解析牌型\n            }\n            if (data.userid == cc.beimi.user.id) {\n                context.game.unselected(context , context.game) ;\n                context.game.lasttakecards(context.game, context, data.cardsnum, lastcards , data);\n            } else {\n                context.getPlayer(data.userid).lasttakecards(context.game, context, data.cardsnum, lastcards , data);\n            }\n\n            context.game.selectedcards.splice(0 ,context.game.selectedcards.length );//清空\n            if(data.over == false){\n                if (data.nextplayer == cc.beimi.user.id) {\n                    context.game.playtimer(context.game, 25 , data.automic);\n                } else {\n                    context.getPlayer(data.nextplayer).playtimer(context.game, 25);\n                }\n            }\n        }else{//出牌不符合规则，需要进行提示\n            context.game.notallow.active = true ;\n            setTimeout(function(){\n                context.game.notallow.active = false ;\n            } , 2000);\n            context.game.unselected(context , context.game);\n        }\n    },\n    /**\n     * 接收到服务端的 出牌提示信息\n     * @param data\n     * @param context\n     */\n    cardtips_event:function(data,context){\n        context.game.unselected(context , context.game) ;\n        if(data.allow == true) {\n            var tipcards = context.decode(data.cards);        //解析牌型\n            context.lasttip = tipcards.join(\",\") ;\n            for(var inx = 0 ; inx < tipcards.length ; inx++){\n                context.game.cardtips(context , tipcards[inx] , tipcards) ;\n            }\n        }else{//出牌不符合规则，需要进行提示\n            context.game.cardtipsfornot(context , context.game);\n        }\n    },\n    /**\n     * 接收到服务端的 推送的 玩家数据，根据玩家数据 恢复牌局\n     * @param data\n     * @param context\n     */\n    play_event:function(data,context){\n        /**\n         * 增加了全局变量，gamestatus , 用于控制当前玩家退出后恢复数据\n         * @type {string}\n         */\n        cc.beimi.gamestatus = \"playing\" ;\n        var mycards = context.decode(data.player.cards);\n        if(context.waittimer){\n            let timer = context.waittimer.getComponent(\"BeiMiTimer\");\n            if(timer){\n                timer.stop(context.waittimer) ;\n            }\n        }\n\n        let center = context.game.pokerpool.get();\n        let left = context.game.pokerpool.get(),right = context.game.pokerpool.get();\n        center.parent = context.root() ;\n        left.parent = context.root() ;\n        right.parent = context.root() ;\n        center.setPosition(0,200);\n        left.setPosition(0,200);\n        right.setPosition(0,200);\n\n        let finished = cc.callFunc(function (target , data) {\n            if(data.game){\n                data.game.pokerpool.put(data.current) ;\n                data.game.pokerpool.put(data.left);\n                data.game.pokerpool.put(data.right);\n\n                /**\n                 * 赋值，解码牌面\n                 */\n                for(var i=0 ; i<data.self.pokercards.length ; i++){\n                    var pokencard = data.self.pokercards[i];\n                    pokencard.getComponent(\"BeiMiCard\").order();\n                }\n\n                data.self.lastCardsPanel.active = true ;\n            }\n        }, this , {game : context.game  , self: context, left :left , right : right , current : center});\n\n        context.doLastCards(context.game , context , 3 , 0);\n\n        /**\n         *  发牌动作，每次6张，本人保留总计17张，其他人发完即回收\n         */\n        setTimeout(function() {\n            context.dealing(context.game , 6 , context , 0 , left , right , mycards) ;\n            setTimeout(function(){\n                context.dealing(context.game , 6 , context , 1, left , right , mycards) ;\n                setTimeout(function(){\n                    context.dealing(context.game , 5 , context , 2, left , right , mycards , finished) ;\n                    context.reordering(context);\n                },500) ;\n            },500) ;\n        }, 0);\n    },\n    /**\n     * 打完牌，进入结算界面，结算界面流程：\n     * 1、提示你赢/输了\n     * 2、1秒后所有玩家的牌翻出来，显示剩余的牌\n     * 3、2秒后显示结算界面\n     * 4、玩家点选明牌开始还是继续游戏\n     * @param data\n     * @param context\n     */\n    allcards_event:function(data , context){\n        /**\n         * 全局变量控制，用于恢复数据\n         * @type {string}\n         */\n        cc.beimi.gamestatus = \"notready\" ;\n        //结算界面，\n        let player ;\n        for(var i=0 ; i<data.players.length ; i++){\n            var temp = data.players[i] ;\n            if(temp.userid != cc.beimi.user.id){\n                var cards = context.decode(temp.cards);        //解析牌型\n                var tempscript = context.getPlayer(temp.userid) ;\n                for(var inx = 0 ; inx < cards.length ; inx++) {\n                    //tempscript.lasttakecards(context.game, context, cards.length, cards, data);\n                    /**\n                     * 最后牌局结束以后，显示所有玩家的手牌\n                     */\n                }\n            }else{\n                player = temp  ;\n            }\n        }\n        if(player!=null) {\n            /**\n             * 更新个人账号资产信息\n             */\n            context.pva(\"gold\" , player.balance);\n            /**\n             * 刷新个人资产显示 , 可以增加相关动画显示，duang的一声，显示的金币变成金光闪闪的，然后再变回去\n             */\n            context.updatepva() ;\n        }\n        setTimeout(function(){\n            if(player!=null){\n                if(player.win == true){\n                    context.summarypage = cc.instantiate(context.summary_win) ;\n                }else{\n                    context.summarypage = cc.instantiate(context.summary) ;\n                }\n                context.summarypage.parent = context.root() ;\n                let temp = context.summarypage.getComponent(\"SummaryDetail\") ;\n                temp.create(context , data);\n            }\n            /**\n             * 隐藏顶部的 底牌 显示区域\n             * @type {boolean}\n             */\n            context.lastCardsPanel.active = false ;\n\n            if(data.gameRoomOver == true){//房间解散\n                for(var inx = 0 ; inx<context.player.length ; inx++){\n                    context.player[inx].destroy();\n                }\n                context.player.splice(0 , context.player.length) ;//房间解散，释放资源\n                context.player = new Array();\n                context.clean();\n            }\n        } , 2000);\n\n    },\n    getPlayer:function(userid){\n        var tempRender;\n        for(var inx =0 ; inx<this.player.length ; inx++){\n            var render = this.player[inx].getComponent(\"PlayerRender\") ;\n            if(render.userid && render.userid == userid){\n                tempRender = render ; break ;\n            }\n        }\n        return tempRender ;\n    },\n    dealing:function(game , num , self , times , left , right , cards , finished){\n        /**\n         * 处理当前玩家的 牌， 发牌 ，  17张牌， 分三次动作处理完成\n         */\n        for(var i=0 ; i<num ; i++){\n            var myCards = self.current(game , self ,times * 300 + i * 50-300, cards[times * 6 + i] , finished) ;\n            this.registerProxy(myCards);\n        }\n        self.otherplayer(left  , 0 , num ,game , self) ;\n        self.otherplayer(right , 1 , num ,game , self) ;\n\n    },\n    otherplayer:function(currpoker , inx, num ,game , self){\n        if(inx == 0){\n            let seq = cc.sequence(\n                cc.spawn(cc.moveTo(0.2, -350, 50) , cc.scaleTo(0.2, 0.3, 0.3)) , cc.moveTo(0 , 0 , 200) , cc.scaleTo(0, 1, 1)\n            );\n            currpoker.runAction(seq);\n        }else{\n            let seq = cc.sequence(\n                cc.spawn(cc.moveTo(0.2, 350, 50) , cc.scaleTo(0.2, 0.3, 0.3)) , cc.moveTo(0 , 0 , 200) , cc.scaleTo(0, 1, 1)\n            );\n            currpoker.runAction(seq);\n        }\n        //currpoker.setScale(1);\n        var render = self.player[inx].getComponent(\"PlayerRender\") ;\n        for(var i=0 ; i<num ; i++){\n            render.countcards(1);\n        }\n    },\n    doLastCards:function(game , self , num , card){//发三张底牌\n        for(var i=0 ; i<num ; i++){\n            var width = i * 80 - 80;\n            let currpoker = game.minpokerpool.get() ;\n            currpoker.getComponent(\"BeiMiCard\").setCard(card) ;\n            currpoker.card = card ;\n            currpoker.parent = this.lastCardsPanel;\n            currpoker.setPosition(width , 0);\n\n            self.lastcards[self.lastcards.length] = currpoker ;\n        }\n    },\n    registerProxy:function(myCard){\n        if(myCard){\n            var beiMiCard = myCard.getComponent(\"BeiMiCard\") ;\n            beiMiCard.proxy(this.game);\n        }\n    },\n    playcards:function(game , self , posx , card){\n        return self.current(game ,self , posx , card , null);\n    },\n    current:function(game , self , posx , card , func){\n        let currpoker = game.pokerpool.get() ;\n        var beiMiCard = currpoker.getComponent(\"BeiMiCard\") ;\n        beiMiCard.setCard(card) ;\n        currpoker.card = card ;\n        currpoker.parent = self.poker ;\n        currpoker.setPosition(0,200);\n\n        currpoker.setScale(1,1);\n        currpoker.zIndex = 100 - card ;\n\n        self.pokercards.push(currpoker);\n\n        if(func!=null){\n            let seq = cc.sequence(cc.moveTo(0.2, posx, -180) , func);\n            currpoker.runAction(seq);\n        }else{\n            let action = cc.moveTo(0.2, posx, -180) ;\n            currpoker.runAction(action);\n        }\n        return currpoker;\n    },\n    reordering:function(self){\n        for(var i=0 ; i<self.pokercards.length ; i++){\n            self.pokercards[i].parent = self.poker ;\n        }\n    },\n    newplayer:function(inx , self , data , isRight){\n        var pos = cc.v2(520, 100) ;\n        if(isRight == false){\n            pos = cc.v2(-520,100) ;\n        }\n        let game = self.getCommon(\"DizhuDataBind\");\n        if(game && game.playerspool.size() > 0){\n            self.player[inx] = game.playerspool.get() ;\n            self.player[inx].parent = self.root() ;\n            self.player[inx].setPosition(pos);\n            var render = self.player[inx].getComponent(\"PlayerRender\") ;\n            render.initplayer(data , isRight);\n        }\n    },\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n    /**\n     * 不抢/叫地主\n     */\n    givup:function(){\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"giveup\",\"giveup\");\n        }\n    },\n    /**\n     * 开始游戏\n     */\n    startgame:function(opendeal){\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"start\",opendeal);\n        }\n    },\n    /**\n     * 不抢/叫地主\n     */\n    cardtips:function(){\n        if(this.ready()){\n            let socket = this.socket();\n\n            if(this.lasttip!=null){\n                socket.emit(\"cardtips\",this.lasttip);\n            }else{\n                socket.emit(\"cardtips\",\"\");\n            }\n            this.lasttip = null ;\n        }\n    },\n    /**\n     * 抢/叫地主触发事件\n     */\n    docatch:function(){\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"docatch\",\"docatch\");\n        }\n    },\n    /**\n     * 出牌\n     */\n    doPlayCards:function(){\n        if(this.ready()){\n            let socket = this.socket();\n            this.game.selectedcards.splice(0 , this.game.selectedcards.length) ;\n            for(var i=0 ; i<this.pokercards.length ; i++){\n                var card = this.pokercards[i] ;\n                var temp = card.getComponent(\"BeiMiCard\");\n                if(temp.selected == true){\n                    this.game.selectedcards.push(temp.card) ;\n                }\n            }\n            socket.emit(\"doplaycards\" , this.game.selectedcards.join());\n        }\n        this.lasttip = null ;\n    },\n    /**\n     * 不出牌\n     */\n    noCards:function(){\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"nocards\",\"nocards\");\n        }\n        this.lasttip = null ;\n    },\n    clean:function(){\n        for(var inx = 0 ; inx<this.pokercards.length ; inx++){\n            let pc = this.pokercards[inx] ;\n            this.game.pokerpool.put(pc) ;//回收回去\n        }\n        this.pokercards.splice(0 , this.pokercards.length ) ;\n        for(var i=0 ; i<this.lastcards.length ; i++){\n            this.game.minpokerpool.put(this.lastcards[i]);\n        }\n\n        this.lastcards.splice( 0 , this.lastcards.length) ;\n\n        for(var i = 0 ; i < this.player.length ; i++){\n            var player = this.player[i].getComponent(\"PlayerRender\") ;\n            player.clean(this.game);\n        }\n        this.player.splice(0 , this.player.length) ;\n\n        this.game.clean(this);\n        this.ratio.string = \"15倍\" ;\n    },\n    onCloseClick:function(){\n        this.continuegamebtn.active = true ;\n    },\n    restart:function(command){\n        this.game.restart();\n        this.statictimer(\"正在匹配玩家\" , 5) ;\n        /**\n         * 系统资源回收完毕，发送一个 重新开启游戏的 通知\n         */\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"restart\" , command);\n        }\n    },\n    continuegame:function(){\n        this.continuegamebtn.active = false ;\n        this.restart(\"begin\");\n    },\n    statictimer:function(message , time){\n        this.waittimer = cc.instantiate(this.waitting);\n        this.waittimer.parent = this.root();\n\n        let timer = this.waittimer.getComponent(\"BeiMiTimer\");\n        if(timer){\n            timer.init(message , time , this.waittimer);\n        }\n    },\n    onDestroy:function(){\n        this.inited = false ;\n        this.cleanmap();\n        if(this.ready()){\n            let socket = this.socket();\n            socket.emit(\"leave\",\"leave\");\n        }\n    }\n});\n"]}